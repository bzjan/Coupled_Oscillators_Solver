(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    206041,       4909]
NotebookOptionsPosition[    196003,       4731]
NotebookOutlinePosition[    196441,       4748]
CellTagsIndexPosition[    196398,       4745]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Binary data reader", "Title",
 CellChangeTimes->{{3.635402150996275*^9, 
  3.6354021543883266`*^9}},ExpressionUUID->"afb64ab9-a88f-4e8c-9180-\
e644ef25d755"],

Cell[CellGroupData[{

Cell["functions", "Chapter",
 CellChangeTimes->{{3.661175405513986*^9, 
  3.661175409458436*^9}},ExpressionUUID->"954ed11f-c79f-466a-9bd2-\
2ba72ec62414"],

Cell[CellGroupData[{

Cell["notebook init", "Section",
 CellChangeTimes->{{3.668428245429056*^9, 3.668428245739975*^9}, {
  3.680514043273794*^9, 
  3.680514044247552*^9}},ExpressionUUID->"fb043343-b96a-45be-bb66-\
2bb7520f1c73"],

Cell[CellGroupData[{

Cell["init", "Subsection",
 CellChangeTimes->{{3.635489792173023*^9, 
  3.6354897925565567`*^9}},ExpressionUUID->"66218dfd-368c-4327-8cd6-\
533a91b0926f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "remove", " ", "all", " ", "output", " ", "when", " ", 
    "exiting"}], " ", "**)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", 
      RowBox[{"NotebookEventActions", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<WindowClose\>\"", " ", ":>", " ", 
         RowBox[{"FrontEndExecute", "[", 
          RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}],
           "]"}]}], "}"}]}]}], "]"}], ";"}], " ", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "set", " ", "reasonable", " ", "undo", " ", "history"}],
     " ", "**)"}], "\n", 
   RowBox[{
    RowBox[{"$HistoryLength", "=", "10"}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.635618024595356*^9, 3.635618029062488*^9}, {
  3.6824893005660963`*^9, 3.682489329161583*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"d2a4f3a2-0d37-4f1d-805e-6e69416bfd03"]
}, Closed]],

Cell[CellGroupData[{

Cell["legacy functions", "Subsection",
 CellChangeTimes->{{3.657305453783482*^9, 
  3.657305457535404*^9}},ExpressionUUID->"6461c145-0add-4dcf-be7a-\
9e9ba124906e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "10.1"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"MinMax", "[", "array_", "]"}], ":=", 
       RowBox[{"Through", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Min", ",", "Max"}], "}"}], "[", 
         RowBox[{"Flatten", "[", "array", "]"}], "]"}], "]"}]}], ";"}]}], 
    "\n", "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "10.2"}], ",", "\n", 
    RowBox[{
     RowBox[{"Nothing", ":=", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"{", "}"}]}]}], ";"}]}], "\n", "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.657305463534088*^9, 3.657305474684476*^9}, {
   3.667673676404649*^9, 3.6676736814929667`*^9}, 3.6677180716499043`*^9, {
   3.6686996204946823`*^9, 3.668699621463132*^9}, {3.670925854786787*^9, 
   3.670925873756206*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"041d0ed5-dc6b-4c80-ba30-4533367f2f6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["compiler settings", "Subsection",
 CellChangeTimes->{{3.6702191654076543`*^9, 3.6702191691442842`*^9}, {
  3.670219205023316*^9, 
  3.6702192074669375`*^9}},ExpressionUUID->"42519363-4e8e-4416-951c-\
e95a31f04959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<CCompilerDriver`GenericCCompiler`\>\"", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.7035756229579887`*^9, 3.7035756257490025`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"afbf8e75-a17c-4351-a215-e3d9edeee829"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["main", "Section",
 CellChangeTimes->{{3.668428239631733*^9, 
  3.6684282399997873`*^9}},ExpressionUUID->"65b98bf5-ee17-4504-94e6-\
a03e7b7712d3"],

Cell[CellGroupData[{

Cell[TextData[{
 "allperiodsraw: ",
 StyleBox["compute peak positions and periods",
  FontSlant->"Italic"]
}], "Subsection",
 CellChangeTimes->{
  3.661176131649859*^9, {3.668169631721024*^9, 
   3.6681696478088303`*^9}},ExpressionUUID->"3c54804e-d535-4a42-a07c-\
0d86c789e9b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thresh", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"peakpos", ",", "periods"}], "}"}], "=", 
  RowBox[{"allperiodsraw", "[", 
   RowBox[{"timeSeries", ",", "thresh", ",", "mode"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.661175494822648*^9, 3.661175500352014*^9}, {
   3.661175726811077*^9, 3.661175727568138*^9}, 3.6611760693489647`*^9, {
   3.665989407301581*^9, 3.6659894165905867`*^9}, {3.668057798611711*^9, 
   3.6680578024128637`*^9}},ExpressionUUID->"bd912af1-eac0-4284-a2be-\
67ff3bfbf672"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allperiodsraw", "[", 
   RowBox[{"timeSeries_", ",", "thresh_", ",", "mode_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ns", ",", "nstates", ",", "peakNoise", ",", "ppos", ",", "periods", ",",
       "maxpos0", ",", "maxpos", ",", "maxpfs", ",", "peakpos"}], "}"}], ",", 
    "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "progress", " ", "indicator"}], " ", "**)"}], "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "@", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{"\"\<Progress of periods calculation: \>\"", ",", 
          RowBox[{"Overlay", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "napr", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{
                RowBox[{"ToString", "@", 
                 RowBox[{"(", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"napr", " ", "100.0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ")"}]}], "<>", 
                "\"\<\[ThinSpace]%\>\""}], "]"}]}], "}"}], ",", 
            RowBox[{"Alignment", "->", "\"\<Center\>\""}]}], "]"}]}], 
         "}"}]}]}], ";"}], "\n", "*)"}], "\n", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "DEBUG"}], " ", "**)"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "@", 
       RowBox[{"Dynamic", "@", "i"}]}], ";"}], "*)"}], "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ns", ",", "nstates"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "timeSeries", "]"}]}], ";", "\n", 
     RowBox[{"peakNoise", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1*^-6", ",", "nstates"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"peakpos", ",", "periods"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"maxpos0", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"mode", "\[Equal]", "0"}], ",", "\n", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"FindPeaks", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "timeSeries", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", "peakNoise"}], ",", 
                    "Automatic", ",", "Automatic", ",", "thresh"}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
                 ",", 
                RowBox[{"1", "|", "nstates"}]}], "]"}], ",", "\n", 
              RowBox[{"peakDetectX", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "timeSeries", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "+", "peakNoise"}], ",", 
                "thresh"}], "]"}]}], "\n", "]"}]}], ";", "\n", 
           RowBox[{"maxpos", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "maxpos0"}], ">", "2"}], ",", "maxpos0",
               ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "nstates"}], "}"}]}], "]"}]}], ";", "\n", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{"*", " ", "positions", " ", "of", " ", "maxima"}], " ", 
            "**)"}], "\n", 
           RowBox[{"Sow", "[", 
            RowBox[{"maxpos", ",", "ppos"}], "]"}], ";", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", "differences", " ", "between", " ", "maxima"}],
              " ", "=", " ", 
             RowBox[{"periods", " ", "in", " ", "frames"}]}], " ", "**)"}], 
           "\n", 
           RowBox[{"Sow", "[", 
            RowBox[{
             RowBox[{"Differences", "[", "maxpos", "]"}], ",", "maxpfs"}], 
            "]"}], ";"}], "\n", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"napr", "=", 
             RowBox[{"N", "[", 
              RowBox[{"i", "/", "ns"}], "]"}]}], ";"}], "*)"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ns"}], "}"}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", "\n", 
     "\n", 
     RowBox[{"{", 
      RowBox[{"peakpos", ",", "periods"}], "}"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.65928536537912*^9, 3.6592853690580997`*^9}, {
   3.659285449417756*^9, 3.659285460581232*^9}, 3.659285507850059*^9, {
   3.659285546126651*^9, 3.659285556154749*^9}, {3.65928583416521*^9, 
   3.659285834556411*^9}, {3.659285971531877*^9, 3.659285976412011*^9}, 
   3.659286127444461*^9, {3.659286376566571*^9, 3.659286391487129*^9}, {
   3.659444993416854*^9, 3.659444996182755*^9}, {3.659445092558783*^9, 
   3.659445097158556*^9}, {3.659445133694456*^9, 3.659445190033698*^9}, 
   3.659445355882085*^9, {3.65944540418325*^9, 3.659445455792509*^9}, {
   3.659445677169408*^9, 3.659445708626835*^9}, 3.6594457468098297`*^9, {
   3.659446347700843*^9, 3.6594463515825253`*^9}, {3.665989261450922*^9, 
   3.6659892677394857`*^9}, {3.6659893150074*^9, 3.665989400801524*^9}, {
   3.6659919759166*^9, 3.665992054831443*^9}, 3.667482606166514*^9, 
   3.66750494395538*^9, {3.667505002322555*^9, 3.66750502636331*^9}, {
   3.667507138219762*^9, 3.6675071408355207`*^9}, {3.667507193520411*^9, 
   3.667507194232909*^9}, {3.667507614102161*^9, 3.667507671698284*^9}, {
   3.667507807571691*^9, 3.667507932328535*^9}, {3.6675081127159758`*^9, 
   3.6675081153076963`*^9}, {3.667508161578435*^9, 3.667508266685281*^9}, {
   3.667509035220224*^9, 3.667509043346244*^9}, 3.66750919777378*^9, 
   3.667509845611792*^9, {3.6675115210939703`*^9, 3.667511539991712*^9}, 
   3.668057856587504*^9, 3.66816929644516*^9, {3.668169723897875*^9, 
   3.6681697247605*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"d5ab6054-8073-40ff-a323-a1d06d4c2ede"]
}, Closed]],

Cell[CellGroupData[{

Cell["animate", "Subsection",
 CellChangeTimes->{{3.730972026879108*^9, 3.7309720274071617`*^9}, {
  3.738300352321384*^9, 
  3.7383003529299107`*^9}},ExpressionUUID->"0af4994c-4c70-488b-9a77-\
fca2c0dcd9b3"],

Cell[CellGroupData[{

Cell["animateNetwork", "Subsubsection",
 CellChangeTimes->{{3.7309720587304697`*^9, 
  3.730972068099257*^9}},ExpressionUUID->"a934bdcd-95b0-4267-9a6b-\
93205ec8b026"],

Cell[BoxData[
 RowBox[{
  RowBox[{"animateNetwork", "[", "pth_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "c"}], "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nx", ",", "ns", ",", "nc", ",", "dt", ",", "cdata"}], "}"}], 
      "=", 
      RowBox[{"loadDataFromFile", "[", 
       RowBox[{"pth", ",", "doubleFlag"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "nstates"}], "}"}], "=", 
      RowBox[{"shapeData", "[", 
       RowBox[{"nx", ",", "nc", ",", "cdata"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"If", "[", 
      RowBox[{"phaseFlag", ",", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "phase", " ", "oscillators"}], " ", "**)"}], "\n", 
       "\t", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"u", ",", 
           RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\n", ",", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "amplitude", " ", "oscis"}], " ", "**)"}], "\n", 
       "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"calcPhaseFlag", "\[Or]", "calcPeriodFlag"}], ",", "\n", 
          "\t\t", 
          RowBox[{
           RowBox[{"i", "=", "2"}], ";", "\n", "\t\t", 
           RowBox[{"c", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u", ",", "v"}], "}"}], "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t", 
           RowBox[{"allperioddata", "=", 
            RowBox[{"allperiodsraw", "[", 
             RowBox[{
              RowBox[{"c", "\[Transpose]"}], ",", "thresh", ",", "mode"}], 
             "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"calcPhaseFlag", ",", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"phase", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"calcPhase", "[", 
                 RowBox[{"allperioddata", ",", "nstates", ",", "mode"}], 
                 "]"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{"corotateFlag", ",", 
                RowBox[{"phase", "=", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "corotateIndex", 
                    "\[RightDoubleBracket]"}]}], ")"}], "&"}], "/@", 
                    "phase"}], ",", 
                   RowBox[{"2.0", "\[Pi]"}]}], "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\n", "\t\t", "\n", 
           "\t\t", 
           RowBox[{"interpol", "=", "0"}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"calcPeriodFlag", ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"interpolPeriods", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"calcInstaPeriod", "[", 
                 RowBox[{
                 "allperioddata", ",", "nstates", ",", "interpol", ",", 
                  "mode"}], "]"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p1", ",", "p2"}], "}"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.95", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{"1.05", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "&"}], "@", 
                RowBox[{"(", 
                 RowBox[{"dt", " ", 
                  RowBox[{"MinMax", "[", "interpolPeriods", "]"}]}], 
                 ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"periodTicks", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "i", "]"}], ",", "#", ",", 
                    "\"\<\>\""}], "]"}]}], "}"}], "&"}], "@", 
                  RowBox[{"(", 
                   RowBox[{"p1", "+", 
                    RowBox[{"i", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p2", "-", "p1"}], ")"}], "/", "4"}]}]}], ")"}]}],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]}], 
              ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], 
        ";"}]}], "\n", "]"}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"plotops", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Evaluate", "[", "extraPlotOps", "]"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], ",", "\n", 
        RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "12", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
        ",", "\n", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "300"}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"50", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"visualizerNetwork", "[", "nc", "]"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6684532841124763`*^9, 3.6684533031360693`*^9}, {
   3.6684533466447783`*^9, 3.6684533474291067`*^9}, {3.668698633759263*^9, 
   3.668698633870982*^9}, {3.6686987578140993`*^9, 3.668698767717845*^9}, {
   3.668698807113777*^9, 3.668698808108098*^9}, {3.668698852304204*^9, 
   3.668698858702735*^9}, {3.668699220214231*^9, 3.668699222542486*^9}, {
   3.668699256898921*^9, 3.668699259692581*^9}, {3.668699342083621*^9, 
   3.668699343291153*^9}, {3.668699378381812*^9, 3.668699413008191*^9}, {
   3.668699452212124*^9, 3.668699494969352*^9}, {3.66869957692626*^9, 
   3.668699585468876*^9}, 3.6719838041939044`*^9, {3.678870391608223*^9, 
   3.6788703973590727`*^9}, {3.679217710374173*^9, 3.679217713631454*^9}, {
   3.681895794215147*^9, 3.681895797245503*^9}, 3.682566948491005*^9, {
   3.694111475395986*^9, 3.694111490949254*^9}, {3.6941115770466747`*^9, 
   3.694111622443359*^9}, {3.694164592774581*^9, 3.694164593023199*^9}, 
   3.694165037328075*^9, 3.696435262290874*^9, {3.6975427302131433`*^9, 
   3.697542731577765*^9}, 3.697760817107916*^9, {3.7243434396467857`*^9, 
   3.724343473191856*^9}, {3.724347061343191*^9, 3.724347061814427*^9}, {
   3.730972071598323*^9, 3.730972101649714*^9}, {3.730975501968392*^9, 
   3.730975506328611*^9}, {3.730975626144437*^9, 3.7309756462459*^9}, {
   3.7309764250868053`*^9, 3.73097642824895*^9}, 3.730976495148818*^9, {
   3.730976900090282*^9, 3.7309769013215714`*^9}, {3.7309770861724367`*^9, 
   3.730977086357153*^9}, {3.730980623015151*^9, 3.73098064126763*^9}, {
   3.730981513335245*^9, 3.730981516038828*^9}, {3.730981666214765*^9, 
   3.730981672975295*^9}, 3.730982361382564*^9, {3.730982470211769*^9, 
   3.7309824962715483`*^9}, {3.738296508148251*^9, 3.738296554897911*^9}, {
   3.738300702171238*^9, 3.7383007484180183`*^9}, 3.738301565556602*^9, {
   3.738310489219859*^9, 3.7383105484301777`*^9}, {3.7396755664288073`*^9, 
   3.739675612982551*^9}, {3.745306421392777*^9, 3.745306428880578*^9}, 
   3.755720118798009*^9, {3.755770290598309*^9, 3.755770372254038*^9}, {
   3.764485752682777*^9, 3.764485848830215*^9}, {3.764569050479707*^9, 
   3.764569052955596*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"dc59cfbd-d3b0-4d07-b8ab-d39aea94830a"]
}, Closed]],

Cell[CellGroupData[{

Cell["animate1d", "Subsubsection",
 CellChangeTimes->{{3.668453377857143*^9, 3.6684533782729177`*^9}, {
   3.6684573706181107`*^9, 3.6684573721703653`*^9}, 3.680513655933571*^9, 
   3.738297367085383*^9},ExpressionUUID->"a1edc3d8-2915-4d2b-8b75-\
484b0cd572e5"],

Cell[BoxData[
 RowBox[{"animate1d", "[", "pth", "]"}]], "Input",
 CellChangeTimes->{{3.668457377691031*^9, 3.6684573810288973`*^9}, 
   3.680513540804323*^9, 3.7569001320426064`*^9, 
   3.7645690806411552`*^9},ExpressionUUID->"41813902-1edd-42a1-ab81-\
28327890ecc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"animate1d", "[", "pth_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nx", ",", "ns", ",", "nc", ",", "dt", ",", "cdata"}], "}"}], 
      "=", 
      RowBox[{"loadDataFromFile", "[", 
       RowBox[{"pth", ",", "doubleFlag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "nstates"}], "}"}], "=", 
      RowBox[{"shapeData", "[", 
       RowBox[{"nx", ",", "nc", ",", "cdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"If", "[", 
      RowBox[{"phaseFlag", ",", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "phase", " ", "oscillators"}], " ", "**)"}], "\n", 
       "\t", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"u", ",", 
           RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\n", ",", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "amplitude", " ", "oscis"}], " ", "**)"}], "\n", 
       "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"calcPhaseFlag", "\[Or]", "calcPeriodFlag"}], ",", "\n", 
          "\t\t", 
          RowBox[{
           RowBox[{"allperioddata", "=", 
            RowBox[{"allperiodsraw", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cdata", "\[LeftDoubleBracket]", 
                RowBox[{"2", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], 
               "\[Transpose]"}], ",", "thresh", ",", "mode"}], "]"}]}], ";", 
           "\n", "\t\t", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"calcPhaseFlag", ",", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"phase0", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"calcPhase", "[", 
                 RowBox[{"allperioddata", ",", "nstates", ",", "mode"}], 
                 "]"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"phase", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"corotateFlag", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "corotateIndex", 
                    "\[RightDoubleBracket]"}]}], ")"}], "&"}], "/@", 
                    "phase0"}], ",", "phase0"}], "]"}], ",", 
                 RowBox[{"2.0", "\[Pi]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\n", "\t\t", "\n", 
           "\t\t", 
           RowBox[{"interpol", "=", "0"}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"calcPeriodFlag", ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"interpolPeriods", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"calcInstaPeriod", "[", 
                 RowBox[{
                 "allperioddata", ",", "nstates", ",", "interpol", ",", 
                  "mode"}], "]"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p1", ",", "p2"}], "}"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.95", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{"1.05", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "&"}], "@", 
                RowBox[{"(", 
                 RowBox[{"dt", " ", 
                  RowBox[{"MinMax", "[", "interpolPeriods", "]"}]}], 
                 ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"periodTicks", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "i", "]"}], ",", "#", ",", 
                    "\"\<\>\""}], "]"}]}], "}"}], "&"}], "@", 
                  RowBox[{"(", 
                   RowBox[{"p1", "+", 
                    RowBox[{"i", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p2", "-", "p1"}], ")"}], "/", "4"}]}]}], ")"}]}],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]}], 
              ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], 
        ";"}]}], "\n", "]"}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"plotops", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Evaluate", "[", "extraPlotOps", "]"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], ",", "\n", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "ns"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "@", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ",", 
               RowBox[{"Max", "@", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}], "&"}], "@", 
            RowBox[{"Transpose", "[", "varsPlotRange", "]"}]}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "12", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "300"}], "}"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"50", ",", "35"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"40", ",", "20"}], "}"}]}], "}"}]}]}], "*)"}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"visualizer1d", "[", "nc", "]"}]}]}], "\[IndentingNewLine]", 
   "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6684532841124763`*^9, 3.6684533031360693`*^9}, {
   3.6684533466447783`*^9, 3.6684533474291067`*^9}, {3.668698633759263*^9, 
   3.668698633870982*^9}, {3.6686987578140993`*^9, 3.668698767717845*^9}, {
   3.668698807113777*^9, 3.668698808108098*^9}, {3.668698852304204*^9, 
   3.668698858702735*^9}, {3.668699220214231*^9, 3.668699222542486*^9}, {
   3.668699256898921*^9, 3.668699259692581*^9}, {3.668699342083621*^9, 
   3.668699343291153*^9}, {3.668699378381812*^9, 3.668699413008191*^9}, {
   3.668699452212124*^9, 3.668699494969352*^9}, {3.66869957692626*^9, 
   3.668699585468876*^9}, 3.6719838041939044`*^9, {3.678870391608223*^9, 
   3.6788703973590727`*^9}, {3.679217710374173*^9, 3.679217713631454*^9}, 
   3.680513539136832*^9, 3.68051361527322*^9, {3.6805138382323017`*^9, 
   3.680513874775704*^9}, 3.682566887076277*^9, {3.7242665771691008`*^9, 
   3.724266582929021*^9}, 3.724266689070549*^9, {3.724266724652011*^9, 
   3.7242667734741697`*^9}, {3.724266863159894*^9, 3.7242669090527287`*^9}, {
   3.724343494773464*^9, 3.724343495372321*^9}, {3.724343573216707*^9, 
   3.7243436286763763`*^9}, {3.724343712687867*^9, 3.724343714108984*^9}, {
   3.724343815627282*^9, 3.72434388151306*^9}, {3.724343915323398*^9, 
   3.724343930405735*^9}, {3.724344189398817*^9, 3.72434420457067*^9}, {
   3.724344259283972*^9, 3.724344298109693*^9}, 3.724344338079441*^9, {
   3.724344379796391*^9, 3.724344395693132*^9}, {3.724344430014658*^9, 
   3.72434444089356*^9}, {3.7243448399814043`*^9, 3.72434486027328*^9}, {
   3.724344960022595*^9, 3.7243449691008*^9}, {3.724345155797545*^9, 
   3.724345167909739*^9}, {3.7243452070460377`*^9, 3.724345262397196*^9}, {
   3.7243453312364264`*^9, 3.724345336343004*^9}, {3.739675348697448*^9, 
   3.739675361637382*^9}, {3.739675405494529*^9, 3.73967544061541*^9}, {
   3.739675477791409*^9, 3.7396754800665703`*^9}, 3.745306368580159*^9, 
   3.756900277904008*^9, 3.7569010013341637`*^9, {3.756901038883048*^9, 
   3.7569010475700197`*^9}, {3.756901114630569*^9, 3.7569011218576183`*^9}, {
   3.756901346251683*^9, 3.7569013798173647`*^9}, {3.7569014413271847`*^9, 
   3.7569014717458677`*^9}, {3.756901553301572*^9, 3.756901555304109*^9}, {
   3.756901640486326*^9, 3.756901645095639*^9}, {3.756901839267565*^9, 
   3.756901840907815*^9}, 3.7569021334676847`*^9, {3.7644846948426733`*^9, 
   3.764484702999909*^9}, 3.764485771643454*^9, {3.764485909678562*^9, 
   3.764485962644573*^9}, {3.764569062229128*^9, 3.7645690654913816`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"b4f48329-0f18-4e41-a226-e663d26a0c64"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["calcInstaPeriod", "Subsection",
 CellChangeTimes->{{3.6613407565314913`*^9, 3.661340760292194*^9}, 
   3.6719834077042265`*^9},ExpressionUUID->"cdb8f40b-ac9e-4a89-962a-\
12105ae80cfc"],

Cell["generates instantaneous interpolated periods", "Text",
 CellChangeTimes->{
  3.6613408594435587`*^9},ExpressionUUID->"a3e8a4cc-0c8d-4173-bb20-\
c070bfd7d04c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thresh", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allperioddata", "=", 
   RowBox[{"allperiodsraw", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cdata", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], 
      "\[Transpose]"}], ",", "thresh", ",", "1"}], "]"}]}], ";"}]}], "Input",E\
xpressionUUID->"f9423b92-06db-426e-af6b-b66aefc8d01b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", "calculate", " ", "insta", " ", "periods"}], ",", " ", 
    RowBox[{
     RowBox[{"2000", "\[ThinSpace]", "nodes"}], " ", "=", " ", 
     RowBox[{"35", "\[ThinSpace]", "s"}]}]}], " ", "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"interpol", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mode", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<time for period interpolation: \>\"", ",", 
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"interpolPeriods", "=", 
            RowBox[{"calcInstaPeriod", "[", 
             RowBox[{
             "allperioddata", ",", "nstates", ",", "interpol", ",", "mode"}], 
             "]"}]}], ";"}], "\[IndentingNewLine]", "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "1"}], "}"}]}], "]"}], ",", 
      "\"\<\[ThinSpace]s\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661340776623652*^9, 3.661340782343848*^9}, {
   3.66134089923202*^9, 3.6613409058955097`*^9}, {3.6613410395757923`*^9, 
   3.661341041065617*^9}, 3.661341091172471*^9, {3.667924658613782*^9, 
   3.667924660152483*^9}, {3.6679247448785677`*^9, 3.6679247623556643`*^9}, 
   3.671983506803895*^9},ExpressionUUID->"4352da50-1998-4338-be09-\
35b090bd581e"],

Cell[CellGroupData[{

Cell["test", "Subsubsection",
 CellChangeTimes->{{3.668011753036767*^9, 
  3.6680117551243143`*^9}},ExpressionUUID->"97e0c091-318a-4566-9768-\
03ab937af242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"interpol", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ip", "=", 
       RowBox[{"calcInstaPeriod", "[", 
        RowBox[{
        "allperioddata", ",", "nstates", ",", "interpol", ",", "mode"}], 
        "]"}]}], ";"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ipX", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"peakpos", "=", 
          RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"periods", "=", 
          RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "maximadiffs"}], "<", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.0", ",", "nstates"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"instaPeriodCalcC", "[", 
            RowBox[{
            "peakpos", ",", "periods", ",", "nstates", ",", "interpol"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ipX2", "=", 
      RowBox[{"(*", 
       RowBox[{"Table", "["}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"peakpos", "=", 
         RowBox[{
         "allperioddata", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"periods", "=", 
         RowBox[{
         "allperioddata", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "maximadiffs"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.0", ",", "nstates"}], "]"}], ","}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"instaPeriodCalcC", "[", 
       RowBox[{
        RowBox[{
        "allperioddata", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "allperioddata", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", "nstates", ",", "interpol"}], 
       "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}], "*)"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ip", "\[Equal]", "ipX"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"Chop", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ip", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}], 
       "-", 
       RowBox[{
       "ipX", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}]}], 
      ")"}]}], "]"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peakpos", "=", 
   RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"periods", "=", 
   RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"peakpos", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", 
  RowBox[{"{", 
   RowBox[{"peakpos", ",", "periods"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"peakpos", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", "periods"}], 
       "}"}], "\[Transpose]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ip", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "ipX", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "}"}],
      ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Red"}], "}"}]}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.667896599646289*^9, 3.667896687372916*^9}, {
   3.6678967596945267`*^9, 3.667896770358523*^9}, {3.6679030014992*^9, 
   3.667903029696087*^9}, 3.667906252677281*^9, {3.667995805447714*^9, 
   3.667995805890029*^9}, 3.667998522325396*^9, 3.66799857892871*^9, 
   3.667998900204674*^9, 3.66799895402283*^9, 3.667999390577979*^9, 
   3.668008655761469*^9, 3.668008890207376*^9, 3.668008990452763*^9, {
   3.6680115802866907`*^9, 3.668011596030714*^9}, {3.668011649763484*^9, 
   3.6680116717909317`*^9}, {3.668011722808714*^9, 3.668011723084866*^9}, {
   3.6680189847906837`*^9, 3.6680190377706347`*^9}, 
   3.6719835153763847`*^9},ExpressionUUID->"5751b3a9-b331-4548-95b5-\
a5b138f77690"]
}, Closed]],

Cell[CellGroupData[{

Cell["code", "Subsubsection",
 CellChangeTimes->{{3.6680117609427013`*^9, 
  3.6680117612204*^9}},ExpressionUUID->"8a4a47f5-242b-4dc9-8c90-cbf71060c96a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcInstaPeriod", "[", 
   RowBox[{
   "allperioddata_List", ",", "tlen_", ",", "interpol_", ",", "mode_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"li", ",", "peakpos", ",", "periods", ",", "ns"}], "}"}], ",", 
    "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{"peakpos", "=", 
      RowBox[{
      "allperioddata", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\n", 
     RowBox[{"periods", "=", 
      RowBox[{
      "allperioddata", "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], ";", "\n", 
     RowBox[{"ns", "=", 
      RowBox[{"Length", "[", "peakpos", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "progress", " ", "indicator"}], " ", "**)"}], "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "@", 
        RowBox[{"Row", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<Progress of period interpolation: \>\"", ",", 
           RowBox[{"Overlay", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ProgressIndicator", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "ncip", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Dynamic", "[", 
                RowBox[{
                 RowBox[{"ToString", "@", 
                  RowBox[{"(", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"100.", " ", "ncip"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ")"}]}], "<>", 
                 "\"\<\[ThinSpace]%\>\""}], "]"}]}], "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "\"\<Center\>\""}]}], "]"}]}], 
          "}"}]}]}], ";"}], "\n", "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "calculation"}], " ", "**)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mode", "\[Equal]", "1"}], "\[And]", 
        RowBox[{"interpol", "<", "2"}]}], ",", "\n", 
       RowBox[{"calcInstaPeriodC", "[", 
        RowBox[{"peakpos", ",", "periods", ",", "tlen", ",", "interpol"}], 
        "]"}], ",", "\n", 
       RowBox[{"Table", "[", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ncip", "=", 
           RowBox[{"N", "[", 
            RowBox[{"i", "/", "ns"}], "]"}]}], ";"}], "*)"}], "\n", "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "periods"}], "<", "2"}], ",", "\n", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.0", ",", "tlen"}], "]"}], ",", "\n", 
           RowBox[{
            RowBox[{"li", "=", 
             RowBox[{"ListInterpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "}"}], ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "&"}], "/@", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"1.0", ",", 
                    RowBox[{"periods", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"peakpos", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "periods", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tlen", "+", "0.1"}], ",", 
                    RowBox[{"periods", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], 
                   "}"}]}], "]"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "interpol"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"li", "[", "t", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "tlen"}], "}"}]}], "]"}]}]}], "\n", "]"}], 
         "\n", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], "]"}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{
  3.661340766988456*^9, {3.661340819038185*^9, 3.6613408240519867`*^9}, {
   3.661340878988253*^9, 3.661340886018876*^9}, {3.661340924834948*^9, 
   3.661341001936781*^9}, {3.661341209519087*^9, 3.6613412118730097`*^9}, {
   3.6660017799949303`*^9, 3.666001780984804*^9}, {3.667463646295682*^9, 
   3.667463664951819*^9}, {3.667463741668055*^9, 3.667463874358594*^9}, 
   3.667482588141917*^9, {3.6675099328635674`*^9, 3.6675100673230553`*^9}, {
   3.667924400896598*^9, 3.667924502172339*^9}, {3.667924538284915*^9, 
   3.667924555818351*^9}, {3.667924614887635*^9, 3.6679246153961477`*^9}, {
   3.667924721404517*^9, 3.667924737356583*^9}, {3.668009153469316*^9, 
   3.668009155929071*^9}, {3.6681711820977087`*^9, 3.66817120126344*^9}, 
   3.6681714413448277`*^9, {3.668171475068163*^9, 3.6681714795941257`*^9}, {
   3.669388981943763*^9, 3.6693890395637083`*^9}, {3.6719833949944997`*^9, 
   3.67198340129886*^9}, 3.671983560430962*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"afe133c3-4aed-48e1-b14c-ca02fc9221e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["compiled code", "Subsubsection",
 CellChangeTimes->{{3.667893465421348*^9, 3.66789346672121*^9}, {
  3.668011768573957*^9, 
  3.6680117702003593`*^9}},ExpressionUUID->"6f020d42-149f-4f64-9921-\
f8d775614470"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CompiledFunctionTools`\>\"", "]"}]], "Input",Expre\
ssionUUID->"0399d467-4e2a-4d47-a94f-2779be650f8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompilePrint", "[", "calcInstaPeriodC", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.667799721259326*^9, 3.667799746225183*^9}, 
   3.667800184190839*^9, 3.667893891398485*^9, {3.667895905736308*^9, 
   3.667895925550558*^9}, {3.667896835527049*^9, 3.667896848717671*^9}, {
   3.667904475916441*^9, 3.6679044828817797`*^9}, {3.667922370126523*^9, 
   3.6679223734810877`*^9}, {3.66799576734068*^9, 3.667995780594363*^9}, {
   3.6679996451924*^9, 3.6679996573222313`*^9}, 
   3.671983555944705*^9},ExpressionUUID->"05b2ba59-5c81-40b4-98cc-\
a6c2ffda0cd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcInstaPeriodC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"peakpos", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"periods", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nstates", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"interpol", ",", "_Integer"}], "}"}]}], "}"}], ",", "\n", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"iperiods", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"{", "nstates", "}"}]}], "]"}]}], ",", 
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"x0", "=", "1.0"}], ",", 
         RowBox[{"x1", "=", 
          RowBox[{
          "peakpos", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
          ",", 
         RowBox[{"y0", "=", 
          RowBox[{
          "periods", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
          ",", 
         RowBox[{"y1", "=", 
          RowBox[{
          "periods", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
          ",", "\n", 
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y0"}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"x1", "-", "x0"}], ")"}]}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "m"}], "*", "x0"}], "+", "y0"}]}], ",", 
         RowBox[{"nps", "=", 
          RowBox[{"Length", "@", "periods"}]}], ",", 
         RowBox[{"npks", "=", 
          RowBox[{"Length", "@", "peakpos"}]}]}], "}"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nps", ">", "1"}], ",", "\n", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"interpol", "\[Equal]", "0"}], ",", "\n", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"*", " ", "interpolation", " ", "order"}], " ", "=", 
               " ", "0"}], " ", "**)"}], "\n", 
             RowBox[{
              RowBox[{"Do", "[", "\n", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"t", ">", 
                    RowBox[{"peakpos", "\[LeftDoubleBracket]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"i", ",", "npks"}], "]"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{
                    RowBox[{"i", "++"}], ";", 
                    RowBox[{"y0", "=", 
                    RowBox[{"periods", "\[LeftDoubleBracket]", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], ",", "nps"}], 
                    "]"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], ";", "\n", 
                 RowBox[{
                  RowBox[{
                  "iperiods", "\[LeftDoubleBracket]", "t", 
                   "\[RightDoubleBracket]"}], "=", "y0"}], ";"}], "\n", ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "nstates"}], "}"}]}], "]"}], ";"}], ",", 
             "\n", "\n", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"*", " ", "interpolation", " ", "order"}], " ", "=", 
               " ", "1"}], " ", "**)"}], "\n", 
             RowBox[{
              RowBox[{"Do", "[", "\n", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"t", ">", "x1"}], ",", "\n", 
                   RowBox[{
                    RowBox[{"i", "++"}], ";", "\n", 
                    RowBox[{"x0", "=", 
                    RowBox[{"peakpos", "\[LeftDoubleBracket]", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"y0", "=", 
                    RowBox[{"periods", "\[LeftDoubleBracket]", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], ",", "nps"}], 
                    "]"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
                    RowBox[{"x1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", "npks"}], ",", 
                    RowBox[{
                    "peakpos", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "nstates"}], "]"}]}], ";", 
                    RowBox[{"y1", "=", 
                    RowBox[{"periods", "\[LeftDoubleBracket]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"i", ",", "nps"}], "]"}], 
                    "\[RightDoubleBracket]"}]}], ";", "\n", "\n", 
                    RowBox[{"m", "=", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"(", 
                    RowBox[{"y1", "-", "y0"}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"x1", "-", "x0"}], ")"}]}]}], ";", "\n", 
                    RowBox[{"b", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "m"}], "*", "x0"}], "+", "y0"}]}], ";"}]}], 
                  "]"}], ";", "\n", 
                 RowBox[{
                  RowBox[{
                  "iperiods", "\[LeftDoubleBracket]", "t", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"m", "*", "t"}], "+", "b"}]}], ";"}], "\n", ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "nstates"}], "}"}]}], "]"}], ";"}]}], "\n",
             "]"}], ";"}]}], "]"}], ";", "\n", "\n", "iperiods"}]}], "\n", 
      "]"}], "\n", ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.659286074066205*^9, 3.6592860899958763`*^9}, 
   3.659286374478395*^9, 3.659286408119811*^9, {3.659286540944713*^9, 
   3.659286578197833*^9}, {3.6593767760686493`*^9, 3.659376851563902*^9}, {
   3.659377909055125*^9, 3.659377909390867*^9}, {3.659446446912272*^9, 
   3.659446452037175*^9}, {3.659447841938313*^9, 3.659447849903372*^9}, {
   3.659447905874118*^9, 3.659447959706846*^9}, {3.6594480986700287`*^9, 
   3.65944810221176*^9}, 3.6594485063693*^9, {3.661165251673653*^9, 
   3.661165263088719*^9}, {3.661175761864758*^9, 3.6611757768508453`*^9}, {
   3.665990786067737*^9, 3.665990794047618*^9}, {3.665990871831316*^9, 
   3.665990904669806*^9}, {3.6659909415279284`*^9, 3.6659909478228416`*^9}, {
   3.6674771967957563`*^9, 3.6674772037171497`*^9}, 3.667482622404442*^9, {
   3.667510225564826*^9, 3.6675102412770433`*^9}, {3.667751809381179*^9, 
   3.667751937192279*^9}, 3.667751986376588*^9, {3.667752034316539*^9, 
   3.667752068856523*^9}, 3.667752259954123*^9, 3.667752352721903*^9, {
   3.667752504188336*^9, 3.667752531188937*^9}, {3.667753066037516*^9, 
   3.667753096718307*^9}, {3.667753409473443*^9, 3.667753419133327*^9}, {
   3.667753798130402*^9, 3.6677538026015987`*^9}, {3.667753853204515*^9, 
   3.667753883682177*^9}, {3.667754042466296*^9, 3.66775406020776*^9}, {
   3.667754134328391*^9, 3.6677541377360477`*^9}, {3.667754297354912*^9, 
   3.667754578454187*^9}, 3.6677550203070183`*^9, {3.667755051561118*^9, 
   3.667755056956612*^9}, {3.667755373513858*^9, 3.667755381274275*^9}, {
   3.667755966038093*^9, 3.667755978223927*^9}, {3.667764435106079*^9, 
   3.667764436161051*^9}, 3.667764567149479*^9, 3.667764612222026*^9, {
   3.667799006176426*^9, 3.667799011763172*^9}, {3.667799072091653*^9, 
   3.667799097821691*^9}, {3.6677991323230658`*^9, 3.667799391138009*^9}, {
   3.667799422887937*^9, 3.6677994549178753`*^9}, {3.667799796315168*^9, 
   3.667799802101324*^9}, {3.6678938291082478`*^9, 3.667893866548774*^9}, {
   3.667894650041189*^9, 3.667894714383099*^9}, {3.667895413627864*^9, 
   3.667895439947749*^9}, {3.6678954766037283`*^9, 3.667895614462759*^9}, {
   3.667895713374486*^9, 3.667895732509569*^9}, {3.667895778381822*^9, 
   3.6678957934669237`*^9}, {3.667895826649213*^9, 3.6678958271842318`*^9}, {
   3.667895871458*^9, 3.667895895384161*^9}, {3.667896090992978*^9, 
   3.667896147473043*^9}, {3.667896345192748*^9, 3.667896362935753*^9}, {
   3.6678964131312523`*^9, 3.667896413234023*^9}, {3.667896531245112*^9, 
   3.667896534251421*^9}, {3.6678997114584017`*^9, 3.667899861930482*^9}, {
   3.66790282520553*^9, 3.667902834707224*^9}, {3.667902867010974*^9, 
   3.667902907877571*^9}, {3.6679030508071203`*^9, 3.66790306232703*^9}, {
   3.667906281421514*^9, 3.667906289124515*^9}, {3.667984769321703*^9, 
   3.667984772991046*^9}, 3.667984820694663*^9, {3.667984854916484*^9, 
   3.667984970080847*^9}, {3.6679850541079683`*^9, 3.6679850723613167`*^9}, 
   3.6679930894459763`*^9, 3.667993942528377*^9, 3.667994726993216*^9, {
   3.667994771280429*^9, 3.667994773248953*^9}, {3.66799493370485*^9, 
   3.6679950733922577`*^9}, {3.667995111251684*^9, 3.667995130150231*^9}, {
   3.667995174601619*^9, 3.667995186752887*^9}, {3.6679988738996677`*^9, 
   3.667998880015814*^9}, {3.667999000628951*^9, 3.667999100042658*^9}, {
   3.667999240577334*^9, 3.667999245325733*^9}, {3.667999340141794*^9, 
   3.667999350682974*^9}, {3.6679996333148613`*^9, 3.667999635778075*^9}, {
   3.668001432779664*^9, 3.668001555827053*^9}, {3.6680015969859247`*^9, 
   3.6680015989134912`*^9}, {3.668001635434621*^9, 3.668001653793557*^9}, 
   3.668001777019182*^9, {3.6680018272509813`*^9, 3.668001829827199*^9}, {
   3.6680018832785254`*^9, 3.6680019397065687`*^9}, {3.668008522282261*^9, 
   3.668008596462731*^9}, {3.668018834091979*^9, 3.668018837934082*^9}, {
   3.668019048166073*^9, 3.6680190609456472`*^9}, {3.668019122001892*^9, 
   3.668019154924066*^9}, 3.668019327912772*^9, {3.6719835373466415`*^9, 
   3.671983541098856*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"70107c9c-47e4-499a-bb99-b109f3db27f2"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["calcPhase", "Subsection",
 CellChangeTimes->{3.661176143884262*^9, 
  3.6719837867709084`*^9},ExpressionUUID->"ca6ddbc5-a1b6-4277-9e77-\
1e5c9612998a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thresh", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allperioddata", "=", 
   RowBox[{"allperiodsraw", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cdata", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], 
      "\[Transpose]"}], ",", "thresh", ",", "mode"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.667995515029105*^9, 
  3.667995519395768*^9}},ExpressionUUID->"cb844858-01a1-49dc-8a84-\
f9a12f9dfa39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mode", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phase", "=", 
   RowBox[{
    RowBox[{"calcPhase", "[", 
     RowBox[{"allperioddata", ",", "nstates", ",", "mode"}], "]"}], 
    "\[Transpose]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667923493960668*^9, 3.667923494489295*^9}, 
   3.668011854046228*^9, 
   3.671983788269994*^9},ExpressionUUID->"a79e6b93-ee2b-4cfe-8dde-\
9c0a2a87d75c"],

Cell[CellGroupData[{

Cell["result test", "Subsubsection",
 CellChangeTimes->{{3.682841016688517*^9, 
  3.6828410181209393`*^9}},ExpressionUUID->"bd179d9d-87dd-4fa4-b38f-\
1fa03a8cc8a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allperioddata", "=", 
   RowBox[{"allperiodsraw", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cdata", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], 
      "\[Transpose]"}], ",", "thresh", ",", "mode"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phase", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"ny", ",", "nx"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"calcPhase", "[", 
      RowBox[{"allperioddata", ",", "nstatesPartial", ",", "mode"}], "]"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.682841069769285*^9},ExpressionUUID->"cc0ded1a-87af-494d-96cd-\
8a7ad213fd3c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"MinMax", "[", 
        RowBox[{"phase", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"phase", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "400"}], "}"}]}]}], "]"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nx", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "ny", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.682841022021538*^9, 3.682841026327985*^9}, {
  3.682841090545087*^9, 3.682841268540213*^9}, {3.682841332101635*^9, 
  3.68284133223218*^9}},ExpressionUUID->"ac92a75b-1edd-476f-aa5a-\
9ec9b0996e18"]
}, Closed]],

Cell[CellGroupData[{

Cell["speed test", "Subsubsection",
 CellChangeTimes->{{3.6678934807543707`*^9, 3.667893480978128*^9}, {
  3.682841005750914*^9, 
  3.682841006529332*^9}},ExpressionUUID->"e486f4af-a978-495d-9fc7-\
4eb9ce77d394"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"phase", "=", 
       RowBox[{"calcPhase", "[", 
        RowBox[{"allperioddata", ",", "nstates", ",", "ns", ",", "0"}], 
        "]"}]}], ";"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phaseX", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"maxpos", "=", 
          RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"maximadiffs", "=", 
          RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "maximadiffs"}], "<", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.0", ",", "nstates"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"calcPhaseC", "[", 
            RowBox[{"maxpos", ",", "maximadiffs", ",", "nstates"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phaseX2", "=", 
      RowBox[{"calcPhaseC", "[", 
       RowBox[{
        RowBox[{
        "allperioddata", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "allperioddata", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", "nstates"}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"phase", "\[Equal]", "phaseX"}], "\[IndentingNewLine]", 
 RowBox[{"phaseX", "\[Equal]", "phaseX2"}]}], "Input",
 CellChangeTimes->{{3.66775459694893*^9, 3.667754618059342*^9}, {
   3.6677549268285933`*^9, 3.667754928386882*^9}, {3.667893126309873*^9, 
   3.6678931524633217`*^9}, {3.667893506148755*^9, 3.66789350635388*^9}, {
   3.667893538573783*^9, 3.667893538791484*^9}, {3.667995659278269*^9, 
   3.6679956597208967`*^9}, {3.667995696348461*^9, 3.667995696596664*^9}, {
   3.668019525681665*^9, 3.668019548203968*^9}, {3.668019674087863*^9, 
   3.6680197207690477`*^9}, 3.6719837901721025`*^9, {3.682840910909595*^9, 
   3.682840915500705*^9}},ExpressionUUID->"eebefb80-6982-424b-90b7-\
f33ec3032a6a"]
}, Closed]],

Cell[CellGroupData[{

Cell["code main", "Subsubsection",
 CellChangeTimes->{{3.66789344907119*^9, 
  3.667893456776163*^9}},ExpressionUUID->"5135f093-cfb5-419d-b114-\
37ecdf7b4ab2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcPhase", "[", 
   RowBox[{"allperioddata_", ",", "nstates_", ",", "mode_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ns", ",", "maxpos", ",", "maximadiffs", ",", "phase0", ",", "h", ",", 
      "max1", ",", "max2", ",", "dmax"}], "}"}], ",", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "progress", " ", "indicator"}], " ", "**)"}], "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "@", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{"\"\<Progress of phase calculation: \>\"", ",", 
          RowBox[{"Overlay", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "npc", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{
                RowBox[{"ToString", "@", 
                 RowBox[{"(", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"npc", " ", "100.0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ")"}]}], "<>", 
                "\"\<\[ThinSpace]%\>\""}], "]"}]}], "}"}], ",", 
            RowBox[{"Alignment", "->", "\"\<Center\>\""}]}], "]"}]}], 
         "}"}]}]}], ";"}], "\n", "*)"}], "\n", 
    RowBox[{
     RowBox[{"ns", "=", 
      RowBox[{"Length", "@", 
       RowBox[{
       "allperioddata", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}]}], ";", "\n", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mode", "\[Equal]", "0"}], ",", "\n", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Reap", "[", 
           RowBox[{"Do", "[", "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "find", " ", "peaks", " ", "in", " ", "grayvalue", " ",
               "timeseries"}], " ", "**)"}], "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"maxpos", "=", 
               RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
              "\n", 
              RowBox[{"maximadiffs", "=", 
               RowBox[{"allperioddata", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
              "\n", "\n", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"**", " ", "find"}], " ", "phase"}], " ", "***)"}], 
              "\n", 
              RowBox[{"phase0", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0.0", ",", "nstates"}], "]"}]}], ";", "\n", "\n", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "maximadiffs"}], ">", "1"}], ",", 
                "\n", "\n", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"*", " ", "middle", " ", "part"}], ",", " ", 
                  RowBox[{
                   RowBox[{"first", " ", "peak", " ", "position"}], " ", 
                   "\[LessEqual]", " ", "tstep", " ", "<", " ", 
                   RowBox[{"last", " ", "peak", " ", "position"}]}], ",", " ", 
                  RowBox[{"not", " ", "from", " ", "first", " ", "peak"}], 
                  ",", " ", 
                  RowBox[{
                   RowBox[{"b", "/", "c"}], " ", "it", " ", "needs", " ", 
                   "to", " ", "find", " ", "previous", " ", "maxima", " ", 
                   "for", " ", "phase", " ", "calculation"}]}], " ", "**)"}], 
                "\n", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
                  RowBox[{
                   RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", "i"]}], ")"}], " ", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["t", 
                    RowBox[{"i", "+", "1"}]], "-", 
                    SubscriptBox["t", "i"]}], ")"}]}]}], " ", "=", " ", 
                   RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", "i"]}], ")"}], " ", "/", " ", 
                    SubscriptBox["T", "i"]}]}]}]}], " ", "**)"}], "\n", 
                RowBox[{
                 RowBox[{"h", "=", "1"}], ";", "\n", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"max1", ",", "max2"}], "}"}], "=", 
                  RowBox[{"maxpos", "\[LeftDoubleBracket]", 
                   RowBox[{"h", ";;", 
                    RowBox[{"h", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 ";", "\n", 
                 RowBox[{"dmax", "=", 
                  RowBox[{
                  "maximadiffs", "\[LeftDoubleBracket]", "h", 
                   "\[RightDoubleBracket]"}]}], ";", "\n", 
                 RowBox[{"Do", "[", "\n", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "phase0", "\[LeftDoubleBracket]", "t", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"2.", "\[Pi]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "max1"}], ")"}], "/", "dmax"}]}]}], ";",
                     "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"t", "\[Equal]", "max2"}], ",", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{
                    RowBox[{"h", "++"}], ";", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"max1", ",", "max2"}], "}"}], "=", 
                    RowBox[{"maxpos", "\[LeftDoubleBracket]", 
                    RowBox[{"h", ";;", 
                    RowBox[{"h", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", " ", 
                    RowBox[{"dmax", "=", 
                    RowBox[{
                    "maximadiffs", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}]}], ";"}]}], "\n", "]"}], ";"}], 
                   "\n", ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{
                    "maxpos", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"maxpos", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"*", " ", "beginning", " ", "part"}], ",", " ", 
                   RowBox[{"tstep", " ", "<", " ", 
                    RowBox[{"first", " ", "peak", " ", "position"}]}]}], " ", 
                  "**)"}], "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "*", " ", "before", " ", "the", " ", "first", " ", "peak", 
                    " ", "the", " ", "period", " ", "is", " ", "not", " ", 
                    RowBox[{"defined", ".", " ", "So"}], " ", "assume", " ", 
                    "unknown", " ", "period", " ", "to", " ", "be", " ", 
                    "identical", " ", "to", " ", "first", " ", "period", " ", 
                    "and", " ", "the", " ", "difference", " ", "to", " ", 
                    "future"}], ",", " ", 
                   RowBox[{"not", " ", "past"}], ",", " ", 
                   RowBox[{"peak", "."}]}], " ", "**)"}], "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
                   RowBox[{
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["t", "1"], "-", 
                    SubscriptBox["T", "1"]}], ")"}]}], ")"}], " ", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["t", "2"], "-", 
                    SubscriptBox["t", "1"]}], ")"}]}]}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", "1"], " ", "+", " ", 
                    SubscriptBox["T", "1"]}], ")"}], " ", "/", " ", 
                    SubscriptBox["T", "1"]}]}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]"}], " ", "+", " ", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", "1"]}], ")"}], " ", "/", " ", 
                    SubscriptBox["T", "1"]}]}]}]}]}]}], " ", "**)"}], "\n", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "phase0", "\[LeftDoubleBracket]", "t", 
                    "\[RightDoubleBracket]"}], " ", "=", " ", 
                    RowBox[{"2.", "\[Pi]", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", " ", "+", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{
                    "maxpos", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], "/", 
                    RowBox[{
                    "maximadiffs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ";"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", "1", ",", 
                    RowBox[{
                    RowBox[{
                    "maxpos", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}], 
                 ";", "\n", "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"*", " ", "final", " ", "part"}], ",", " ", 
                   RowBox[{"tstep", " ", "\[GreaterEqual]", " ", 
                    RowBox[{"last", " ", "peak", " ", "position"}]}]}], " ", 
                  "**)"}], "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                  "*", " ", "The", " ", "period", " ", "after", " ", "the", 
                   " ", "last", " ", "peak", " ", "is", " ", "not", " ", 
                   RowBox[{"defined", ".", " ", "So"}], " ", "take", " ", 
                   "period", " ", "before", " ", "last", " ", "peak", " ", 
                   "and", " ", "do", " ", "the", " ", "usual", " ", 
                   RowBox[{"calculation", "."}]}], " ", "**)"}], "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
                   RowBox[{
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", 
                    RowBox[{"-", "1"}]]}], ")"}], " ", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["t", 
                    RowBox[{"-", "1"}]], "-", 
                    SubscriptBox["t", 
                    RowBox[{"-", "2"}]]}], ")"}]}]}], " ", "=", " ", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    SubscriptBox["t", 
                    RowBox[{"-", "1"}]]}], ")"}], " ", "/", " ", 
                    SubscriptBox["T", 
                    RowBox[{"-", "1"}]]}]}]}]}], " ", "**)"}], "\n", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "phase0", "\[LeftDoubleBracket]", "t", 
                    "\[RightDoubleBracket]"}], " ", "=", " ", 
                    RowBox[{"2.", "\[Pi]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"maxpos", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
                    "/", 
                    RowBox[{"maximadiffs", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
                    ";"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"maxpos", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "nstates"}], "}"}]}], "]"}], ";"}]}], "\n", "]"}], ";", 
              "\n", "\n", 
              RowBox[{"(*", 
               RowBox[{"*", " ", "save", " ", "phase"}], " ", "**)"}], "\n", 
              RowBox[{"Sow", "[", "phase0", "]"}], ";"}], "\n", "\n", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"npc", "=", 
                RowBox[{"N", "[", 
                 RowBox[{"i", "/", "ns"}], "]"}]}], ";"}], "*)"}], "\n", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "ns"}], "}"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"2.0", "\[Pi]"}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"*", " ", "mode"}], "=", 
         RowBox[{"1", ":", " ", 
          RowBox[{"fast", " ", "compiled", " ", "code"}]}]}], " ", "**)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"calcPhaseC", "[", 
        RowBox[{
         RowBox[{
         "allperioddata", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "allperioddata", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", "nstates"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.659286074066205*^9, 3.6592860899958763`*^9}, 
   3.659286374478395*^9, 3.659286408119811*^9, {3.659286540944713*^9, 
   3.659286578197833*^9}, {3.6593767760686493`*^9, 3.659376851563902*^9}, {
   3.659377909055125*^9, 3.659377909390867*^9}, {3.659446446912272*^9, 
   3.659446452037175*^9}, {3.659447841938313*^9, 3.659447849903372*^9}, {
   3.659447905874118*^9, 3.659447959706846*^9}, {3.6594480986700287`*^9, 
   3.65944810221176*^9}, 3.6594485063693*^9, {3.661165251673653*^9, 
   3.661165263088719*^9}, {3.661175761864758*^9, 3.6611757768508453`*^9}, {
   3.665990786067737*^9, 3.665990794047618*^9}, {3.665990871831316*^9, 
   3.665990904669806*^9}, {3.6659909415279284`*^9, 3.6659909478228416`*^9}, {
   3.6674771967957563`*^9, 3.6674772037171497`*^9}, 3.667482622404442*^9, {
   3.667510225564826*^9, 3.6675102412770433`*^9}, {3.66775463639931*^9, 
   3.667754654877612*^9}, {3.667800225318191*^9, 3.667800246777959*^9}, {
   3.667893271222475*^9, 3.667893329852079*^9}, {3.668011823211392*^9, 
   3.6680118472435637`*^9}, 3.668019310681436*^9, {3.668019387089868*^9, 
   3.668019459225778*^9}, {3.66801950181846*^9, 3.668019502177147*^9}, {
   3.668019747361874*^9, 3.668019750343965*^9}, 3.6681717518217297`*^9, {
   3.668172135841763*^9, 3.668172137041485*^9}, 3.6719837914961777`*^9, {
   3.6719838263251705`*^9, 3.671983831058441*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"fa405eb9-b388-4604-a571-5935449fc2d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["compiled code", "Subsubsection",
 CellChangeTimes->{{3.667893465421348*^9, 3.66789346672121*^9}, {
  3.667924323643153*^9, 
  3.6679243276667128`*^9}},ExpressionUUID->"12400b97-75b0-4bc7-85d2-\
4372b21ce056"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CompiledFunctionTools`\>\"", "]"}]], "Input",Expre\
ssionUUID->"1eeec1d0-64a4-4694-b585-3e8a3230149e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompilePrint", "[", "calcPhaseC", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.667799721259326*^9, 3.667799746225183*^9}, 
   3.667800184190839*^9, 
   3.671983845870288*^9},ExpressionUUID->"2e164679-a1bf-4eeb-818f-\
a660bb8c1192"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcPhaseC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"maxpos", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"maximadiffs", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nstates", ",", "_Integer"}], "}"}]}], "}"}], ",", "\n", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"phase0", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"{", "nstates", "}"}]}], "]"}]}], ",", "h", ",", "max1", 
         ",", "max2", ",", "dmax"}], "}"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "maximadiffs"}], ">", "1"}], ",", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"**", " ", "find"}], " ", "phase"}], " ", "***)"}], "\n", 
          "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"*", " ", "middle", " ", "part"}], ",", " ", 
            RowBox[{
             RowBox[{"first", " ", "peak", " ", "position"}], " ", 
             "\[LessEqual]", " ", "tstep", " ", "<", " ", 
             RowBox[{"last", " ", "peak", " ", "position"}]}], ",", " ", 
            RowBox[{"not", " ", "from", " ", "first", " ", "peak"}], ",", " ", 
            RowBox[{
             RowBox[{"b", "/", "c"}], " ", "it", " ", "needs", " ", "to", " ",
              "find", " ", "previous", " ", "maxima", " ", "for", " ", 
             "phase", " ", "calculation"}]}], " ", "**)"}], "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t", "-", 
                 SubscriptBox["t", "i"]}], ")"}], " ", "/", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["t", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["t", "i"]}], ")"}]}]}], " ", "=", " ", 
             RowBox[{"2", "\[Pi]", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t", "-", 
                 SubscriptBox["t", "i"]}], ")"}], " ", "/", " ", 
               SubscriptBox["T", "i"]}]}]}]}], " ", "**)"}], "\n", 
          RowBox[{
           RowBox[{"h", "=", "1"}], ";", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"max1", ",", "max2"}], "}"}], "=", 
            RowBox[{"Part", "[", 
             RowBox[{"maxpos", ",", 
              RowBox[{"h", ";;", 
               RowBox[{"h", "+", "1"}]}]}], "]"}]}], ";", "\n", 
           RowBox[{"dmax", "=", 
            RowBox[{"Part", "[", 
             RowBox[{"maximadiffs", ",", "h"}], "]"}]}], ";", "\n", 
           RowBox[{"Do", "[", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "phase0", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"2.", "\[Pi]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "max1"}], ")"}], "/", "dmax"}]}]}], ";", 
              "\n", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"t", "\[Equal]", "max2"}], ",", "\[IndentingNewLine]",
                 " ", 
                RowBox[{
                 RowBox[{"h", "++"}], ";", "\[IndentingNewLine]", " ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"max1", ",", "max2"}], "}"}], "=", 
                  RowBox[{"Part", "[", 
                   RowBox[{"maxpos", ",", 
                    RowBox[{"h", ";;", 
                    RowBox[{"h", "+", "1"}]}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", " ", 
                 RowBox[{"dmax", "=", 
                  RowBox[{"Part", "[", 
                   RowBox[{"maximadiffs", ",", "h"}], "]"}]}], ";"}]}], "\n", 
               "]"}], ";"}], "\n", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"maxpos", ",", "1"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"maxpos", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
           ";", "\n", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", "beginning", " ", "part"}], ",", " ", 
             RowBox[{"tstep", " ", "<", " ", 
              RowBox[{"first", " ", "peak", " ", "position"}]}]}], " ", 
            "**)"}], "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "before", " ", "the", " ", "first", " ", "peak", " ", 
              "the", " ", "period", " ", "is", " ", "not", " ", 
              RowBox[{"defined", ".", " ", "So"}], " ", "assume", " ", 
              "unknown", " ", "period", " ", "to", " ", "be", " ", 
              "identical", " ", "to", " ", "first", " ", "period", " ", "and",
               " ", "the", " ", "difference", " ", "to", " ", "future"}], ",",
              " ", 
             RowBox[{"not", " ", "past"}], ",", " ", 
             RowBox[{"peak", "."}]}], " ", "**)"}], "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["t", "1"], "-", 
                    SubscriptBox["T", "1"]}], ")"}]}], ")"}], " ", "/", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["t", "2"], "-", 
                  SubscriptBox["t", "1"]}], ")"}]}]}], " ", "=", " ", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", 
                   SubscriptBox["t", "1"], " ", "+", " ", 
                   SubscriptBox["T", "1"]}], ")"}], " ", "/", " ", 
                 SubscriptBox["T", "1"]}]}], " ", "=", " ", 
               RowBox[{
                RowBox[{"2", "\[Pi]"}], " ", "+", " ", 
                RowBox[{"2", "\[Pi]", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", 
                    SubscriptBox["t", "1"]}], ")"}], " ", "/", " ", 
                  SubscriptBox["T", "1"]}]}]}]}]}]}], " ", "**)"}], "\n", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "phase0", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}], " ", "=", " ", 
               RowBox[{"2.", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "+", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"Part", "[", 
                    RowBox[{"maxpos", ",", "1"}], "]"}]}], ")"}], "/", 
                   RowBox[{"Part", "[", 
                    RowBox[{"maximadiffs", ",", "1"}], "]"}]}]}], ")"}]}]}], 
              ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "1", ",", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"maxpos", ",", "1"}], "]"}], "-", "1"}]}], "}"}]}], 
            "]"}], ";", "\n", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", "final", " ", "part"}], ",", " ", 
             RowBox[{"tstep", " ", "\[GreaterEqual]", " ", 
              RowBox[{"last", " ", "peak", " ", "position"}]}]}], " ", 
            "**)"}], "\n", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "The", " ", "period", " ", "after", " ", "the", " ", 
             "last", " ", "peak", " ", "is", " ", "not", " ", 
             RowBox[{"defined", ".", " ", "So"}], " ", "take", " ", "period", 
             " ", "before", " ", "last", " ", "peak", " ", "and", " ", "do", 
             " ", "the", " ", "usual", " ", 
             RowBox[{"calculation", "."}]}], " ", "**)"}], "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", "\[Phi]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "-", 
                  SubscriptBox["t", 
                   RowBox[{"-", "1"}]]}], ")"}], " ", "/", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["t", 
                   RowBox[{"-", "1"}]], "-", 
                  SubscriptBox["t", 
                   RowBox[{"-", "2"}]]}], ")"}]}]}], " ", "=", " ", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "-", 
                  SubscriptBox["t", 
                   RowBox[{"-", "1"}]]}], ")"}], " ", "/", " ", 
                SubscriptBox["T", 
                 RowBox[{"-", "1"}]]}]}]}]}], " ", "**)"}], "\n", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "phase0", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}], " ", "=", " ", 
               RowBox[{"2.", "\[Pi]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", 
                   RowBox[{"Part", "[", 
                    RowBox[{"maxpos", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ")"}], "/", 
                 RowBox[{"Part", "[", 
                  RowBox[{"maximadiffs", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}]}]}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"maxpos", ",", 
                 RowBox[{"-", "1"}]}], "]"}], ",", "nstates"}], "}"}]}], 
            "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
        RowBox[{"Mod", "[", 
         RowBox[{"phase0", ",", 
          RowBox[{"2.0", "\[Pi]"}]}], "]"}]}]}], "\n", "]"}], "\n", ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.659286074066205*^9, 3.6592860899958763`*^9}, 
   3.659286374478395*^9, 3.659286408119811*^9, {3.659286540944713*^9, 
   3.659286578197833*^9}, {3.6593767760686493`*^9, 3.659376851563902*^9}, {
   3.659377909055125*^9, 3.659377909390867*^9}, {3.659446446912272*^9, 
   3.659446452037175*^9}, {3.659447841938313*^9, 3.659447849903372*^9}, {
   3.659447905874118*^9, 3.659447959706846*^9}, {3.6594480986700287`*^9, 
   3.65944810221176*^9}, 3.6594485063693*^9, {3.661165251673653*^9, 
   3.661165263088719*^9}, {3.661175761864758*^9, 3.6611757768508453`*^9}, {
   3.665990786067737*^9, 3.665990794047618*^9}, {3.665990871831316*^9, 
   3.665990904669806*^9}, {3.6659909415279284`*^9, 3.6659909478228416`*^9}, {
   3.6674771967957563`*^9, 3.6674772037171497`*^9}, 3.667482622404442*^9, {
   3.667510225564826*^9, 3.6675102412770433`*^9}, {3.667751809381179*^9, 
   3.667751937192279*^9}, 3.667751986376588*^9, {3.667752034316539*^9, 
   3.667752068856523*^9}, 3.667752259954123*^9, 3.667752352721903*^9, {
   3.667752504188336*^9, 3.667752531188937*^9}, {3.667753066037516*^9, 
   3.667753096718307*^9}, {3.667753409473443*^9, 3.667753419133327*^9}, {
   3.667753798130402*^9, 3.6677538026015987`*^9}, {3.667753853204515*^9, 
   3.667753883682177*^9}, {3.667754042466296*^9, 3.66775406020776*^9}, {
   3.667754134328391*^9, 3.6677541377360477`*^9}, {3.667754297354912*^9, 
   3.667754578454187*^9}, 3.6677550203070183`*^9, {3.667755051561118*^9, 
   3.667755056956612*^9}, {3.667755373513858*^9, 3.667755381274275*^9}, {
   3.667755966038093*^9, 3.667755978223927*^9}, {3.667764435106079*^9, 
   3.667764436161051*^9}, 3.667764567149479*^9, 3.667764612222026*^9, {
   3.667799006176426*^9, 3.667799011763172*^9}, {3.667799072091653*^9, 
   3.667799097821691*^9}, {3.6677991323230658`*^9, 3.667799391138009*^9}, {
   3.667799422887937*^9, 3.6677994549178753`*^9}, {3.667799796315168*^9, 
   3.667799802101324*^9}, {3.667995578235203*^9, 3.66799559556672*^9}, 
   3.66799568832974*^9, 3.668018872729488*^9, {3.6680192412471857`*^9, 
   3.668019254296171*^9}, {3.6680192906607103`*^9, 3.668019316718533*^9}, {
   3.668019349624527*^9, 3.668019370060473*^9}, 3.671983840397975*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"e9f2badf-5ed8-43da-afbf-734428a274d1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["listDirs", "Subsection",
 CellChangeTimes->{{3.668455393811694*^9, 
  3.6684553986763363`*^9}},ExpressionUUID->"e3264696-bfc8-46f1-a7ee-\
693ddfffc748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"listDirs", "[", "pth_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"FileNames", "[", 
     RowBox[{"__", ",", "pth"}], "]"}], ",", "DirectoryQ"}], "]"}]}]], "Code",
 CellChangeTimes->{{3.668453925491576*^9, 3.6684539565429573`*^9}, {
  3.668454135610549*^9, 3.6684541448668613`*^9}, {3.668454193296199*^9, 
  3.668454205025517*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"26e1fb02-1a46-4371-89f6-516a4ed18c8f"]
}, Closed]],

Cell[CellGroupData[{

Cell["loadDataFromFile", "Subsection",
 CellChangeTimes->{
  3.667067550543063*^9, {3.682505009632739*^9, 
   3.6825050317062063`*^9}},ExpressionUUID->"03238664-bf25-4399-85a1-\
23306ce8f61e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nx", ",", "ns", ",", "nc", ",", "dt", ",", "cdata"}], "}"}], "=", 
   RowBox[{"loadDataFromFile", "[", 
    RowBox[{"pth", ",", "doubleFlag"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6679222942216787`*^9, 3.667922302654635*^9}, {
   3.6700649574031506`*^9, 3.6700649620289183`*^9}, {3.670139477202634*^9, 
   3.670139477453271*^9}, 
   3.764246163182913*^9},ExpressionUUID->"30d4c195-47a9-4032-892a-\
646f69975006"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadDataFromFile", "[", 
   RowBox[{"pth_", ",", "doubleFlag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "fn", ",", "fstream", ",", "nx", ",", "ns", ",", "nc", ",", 
      "dt", ",", "rawdata", ",", "cdata"}], "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fn", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"pth", ",", "\"\<states\>\"", ",", "\"\<state.bin\>\""}], 
        "}"}], "]"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "fn"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: File \\\"\>\"", "<>", "fn", "<>", 
          "\"\<\\\" does not exist!\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fstream", "=", 
      RowBox[{"OpenRead", "[", 
       RowBox[{"fn", ",", 
        RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "read", " ", "header"}], " ", "**)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nx", ",", "nc", ",", "dt"}], "}"}], "=", 
      RowBox[{"BinaryRead", "[", 
       RowBox[{"fstream", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Integer32\>\"", ",", "\"\<Integer32\>\"", ",", 
          "\"\<Real32\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ns", "=", "nx"}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "read", " ", "data"}], " ", "**)"}], "\n", 
     RowBox[{"type", "=", 
      RowBox[{"If", "[", 
       RowBox[{"doubleFlag", ",", "\"\<Real64\>\"", ",", "\"\<Real32\>\""}], 
       "]"}]}], ";", "\n", 
     RowBox[{"rawdata", "=", 
      RowBox[{"BinaryReadList", "[", 
       RowBox[{"fstream", ",", "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "fstream", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cdata", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"rawdata", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"nx", ",", "ns", ",", "nc", ",", "dt", ",", "cdata"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.667066167345199*^9, 3.667066193423719*^9}, {
   3.6670662388200502`*^9, 3.667066350229224*^9}, {3.668431941607003*^9, 
   3.668431941781639*^9}, {3.668432093515036*^9, 3.668432095262442*^9}, {
   3.678857411191022*^9, 3.6788574133587637`*^9}, 3.678857748730245*^9, {
   3.678871204611092*^9, 3.678871233082645*^9}, {3.6788712777208757`*^9, 
   3.678871301003048*^9}, {3.678871429024918*^9, 3.6788715256781588`*^9}, {
   3.67887157597094*^9, 3.678871577106049*^9}, {3.6788716092226677`*^9, 
   3.678871685807035*^9}, 3.678871860455415*^9, {3.68250500579312*^9, 
   3.68250500603617*^9}, 3.6825050462268248`*^9, 3.682505093314147*^9, 
   3.682615944693184*^9, {3.6909039310834417`*^9, 3.6909039323297834`*^9}, {
   3.6909040513932257`*^9, 3.690904059500104*^9}, {3.7035762110969734`*^9, 
   3.7035762352170725`*^9}, {3.764246172279647*^9, 3.764246195619573*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"f200ff3d-fc97-453d-a37f-352e9901f9fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["shapeData", "Subsection",
 CellChangeTimes->{
  3.667067555512251*^9},ExpressionUUID->"f4a7823b-2e0b-4b2c-ae03-\
d5c84d185725"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v", ",", "nstates"}], "}"}], "=", 
   RowBox[{"shapeData", "[", 
    RowBox[{"nx", ",", "nc", ",", "cdata"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.682566864999647*^9, {3.7035763218239546`*^9, 3.703576324581905*^9}, 
   3.764565030646991*^9},ExpressionUUID->"0dd418ce-32cc-4784-ba75-\
81847f22f2d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shapeData", "[", 
   RowBox[{"nx_Integer", ",", "nc_Integer", ",", "cdata_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dim", ",", "u", ",", "v", ",", "nstates"}], "}"}], ",", "\n", 
    "\n", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"nc", "\[IndentingNewLine]", ",", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "u", "}"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"cdata", "\[LeftDoubleBracket]", 
            RowBox[{"i", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nc"}], "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"cdata", "\[LeftDoubleBracket]", 
            RowBox[{"i", ";;", ";;", "nc"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nc"}], "}"}]}], "]"}]}], ";"}], "\n", ",", "_",
        ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<nc not supported\>\"", "]"}], ";"}]}], 
      "\n", "]"}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"nstates", "=", 
      RowBox[{"Length", "@", "u"}]}], ";", "\n", "\n", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "nstates"}], "}"}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.667066810895282*^9, 3.667066896630515*^9}, {
   3.66706692944174*^9, 3.667066930313409*^9}, {3.6670669742307987`*^9, 
   3.667066988028791*^9}, {3.667067141209732*^9, 3.667067141489476*^9}, {
   3.667067226765007*^9, 3.6670672925445004`*^9}, {3.667067327686182*^9, 
   3.6670673976076612`*^9}, {3.667067453718101*^9, 3.667067529631752*^9}, 
   3.667510816498835*^9, {3.6684327626104727`*^9, 3.668432765388741*^9}, {
   3.668432833637472*^9, 3.6684328419913597`*^9}, {3.681542471932561*^9, 
   3.68154258503935*^9}, {3.682566851066174*^9, 3.682566861296135*^9}, {
   3.68256704934192*^9, 3.682567108358244*^9}, {3.682567139811495*^9, 
   3.682567143781753*^9}, {3.7035762655069485`*^9, 3.7035763357621655`*^9}, {
   3.764564894337633*^9, 3.764564931584545*^9}, 3.764565553025374*^9, {
   3.7645656611975594`*^9, 3.764565742964581*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"becd7906-2c45-4f1b-aab9-62d76694c993"]
}, Closed]],

Cell[CellGroupData[{

Cell["timingLabel", "Subsection",
 CellChangeTimes->{{3.725731899504435*^9, 
  3.725731901862541*^9}},ExpressionUUID->"1f49b42f-7ba7-4e4e-89e9-\
fe6b4a899c00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timingLabel", "[", 
   RowBox[{"t_", ",", "t0_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"\"\<t = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "1", "+", "t0"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Floor", "[", 
              RowBox[{"Log10", "[", "dt", "]"}], "]"}]}], ",", "1"}], "]"}]}],
          "}"}]}], "]"}], "]"}]}], ",", "Black", ",", 
    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", "20"}], 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.682778318670096*^9, 3.682778329156146*^9}, {
   3.682778423517889*^9, 3.682778423596545*^9}, {3.694163462851817*^9, 
   3.694163463558378*^9}, 3.725732991884939*^9},
 CellLabel->
  "In[196]:=",ExpressionUUID->"181603d2-9243-439c-8401-d24b2d9fcecb"]
}, Closed]],

Cell[CellGroupData[{

Cell["visualizer", "Subsection",
 CellChangeTimes->{{3.7644924516702967`*^9, 
  3.764492453146553*^9}},ExpressionUUID->"ece6d5fa-981e-46c9-af27-\
04b385f971d0"],

Cell[CellGroupData[{

Cell["visualizerNetwork", "Subsubsection",
 CellChangeTimes->{{3.725731868849668*^9, 3.725731870394858*^9}, 
   3.7257320035253487`*^9, {3.7309729141891108`*^9, 
   3.7309729157985983`*^9}},ExpressionUUID->"e3b06e43-7d8b-474c-b407-\
974a3022e323"],

Cell[BoxData[
 RowBox[{"visualizerNetwork", "[", "nc", "]"}]], "Input",
 CellChangeTimes->{
  3.738300578724573*^9},ExpressionUUID->"d887ce41-a4f8-4674-b91d-\
c67f2b5478bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"visualizerNetwork", "[", "nc_", "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"nc", "\[IndentingNewLine]", "\n", ",", "1", ",", "\n", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tt", "=", "t"}], ";", 
       RowBox[{"opic", "=", 
        RowBox[{"nc1FrameNetwork", "[", 
         RowBox[{"t", ",", "0.0"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "\"\<time step t\>\""}], "}"}], ",", "1",
         ",", "nstates", ",", "1", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
        RowBox[{"AnimationRate", "\[Rule]", "10"}]}], "}"}], ",", 
      RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
       RowBox[{"{", "t", "}"}]}]}], "]"}], "\[IndentingNewLine]", "\n", ",", 
    "2", ",", "\n", 
    RowBox[{
     RowBox[{"uvData", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "[", "#1", "]"}], ",", 
            RowBox[{"Flatten", "[", "#2", "]"}]}], "}"}], "\[Transpose]"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{"showLCflag", ",", 
       RowBox[{
        RowBox[{"lcdata0", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{
          "uvData", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", 
        RowBox[{"lcpath", "=", 
         RowBox[{
          RowBox[{"FindShortestTour", "[", "lcdata0", "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tt", "=", "t"}], ";", 
        RowBox[{"opic", "=", 
         RowBox[{"nc2FrameNetwork", "[", 
          RowBox[{"t", ",", "0.0"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", "\"\<time step t\>\""}], "}"}], ",", 
         "1", ",", "nstates", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
         RowBox[{"AnimationRate", "\[Rule]", "10"}]}], "}"}], ",", 
       RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
        RowBox[{"{", "t", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", "_", ",", 
    RowBox[{"Print", "[", "\"\<nc not supported\>\"", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.668411814649486*^9, 3.6684118341036777`*^9}, {
   3.668411938224527*^9, 3.668412069402886*^9}, {3.668412301009351*^9, 
   3.668412301200664*^9}, {3.6684321730810432`*^9, 3.6684321789789677`*^9}, {
   3.6686986263883467`*^9, 3.668698626482737*^9}, {3.668699058929884*^9, 
   3.668699071096651*^9}, {3.668699117227734*^9, 3.668699157445837*^9}, {
   3.669010740410284*^9, 3.669010748899179*^9}, {3.66901092898918*^9, 
   3.669010961113996*^9}, {3.674390784060534*^9, 3.674390810955093*^9}, {
   3.674404062244286*^9, 3.674404062575766*^9}, {3.674404158416294*^9, 
   3.674404196637217*^9}, {3.6744058618346643`*^9, 3.674405879669791*^9}, {
   3.678870449415709*^9, 3.6788704560031233`*^9}, {3.6788705227996807`*^9, 
   3.678870541201662*^9}, {3.678870622825344*^9, 3.678870640604553*^9}, {
   3.678870699347999*^9, 3.678870771633906*^9}, 3.6790745774291553`*^9, {
   3.679074644064931*^9, 3.679074655317416*^9}, {3.679113798768383*^9, 
   3.679113813187026*^9}, {3.679113974298314*^9, 3.6791139945865917`*^9}, {
   3.679217347097267*^9, 3.679217349190832*^9}, {3.679217390843746*^9, 
   3.679217426470125*^9}, {3.679217465350062*^9, 3.679217477925071*^9}, {
   3.679217539731575*^9, 3.679217541680958*^9}, {3.679217589569471*^9, 
   3.679217600729249*^9}, {3.679217728660283*^9, 3.6792177860540533`*^9}, {
   3.679217923695774*^9, 3.6792179506453457`*^9}, {3.679217985144215*^9, 
   3.6792180072289352`*^9}, {3.67921822758447*^9, 3.679218249090651*^9}, 
   3.6792205338001738`*^9, {3.680521392355014*^9, 3.680521420400457*^9}, {
   3.680529104089664*^9, 3.680529133401041*^9}, {3.681579899730311*^9, 
   3.6815799056240263`*^9}, {3.68158031977138*^9, 3.681580329232633*^9}, {
   3.681894663280854*^9, 3.681894724942687*^9}, {3.6818948440493526`*^9, 
   3.681894871622698*^9}, {3.681894917394981*^9, 3.681894966414114*^9}, {
   3.681895229720792*^9, 3.681895344431753*^9}, {3.681895414551293*^9, 
   3.681895459857338*^9}, 3.681895520399269*^9, {3.681895664790264*^9, 
   3.681895677867165*^9}, {3.6818957545897417`*^9, 3.681895764272451*^9}, {
   3.681896381175384*^9, 3.681896401569449*^9}, {3.681897517245496*^9, 
   3.681897517458893*^9}, {3.681897554159525*^9, 3.681897567811441*^9}, {
   3.681959858832119*^9, 3.681959862182825*^9}, {3.6821546561407347`*^9, 
   3.682154682020873*^9}, 3.6821547991812563`*^9, 3.682154921611393*^9, {
   3.682490012562806*^9, 3.682490015101344*^9}, {3.68249009858948*^9, 
   3.682490242543503*^9}, {3.6824903519413424`*^9, 3.6824903561019583`*^9}, {
   3.6825042822443113`*^9, 3.6825042838293543`*^9}, {3.6827780803272676`*^9, 
   3.6827780925764227`*^9}, {3.682778649596073*^9, 3.682778657522019*^9}, {
   3.6848243119417467`*^9, 3.684824322246684*^9}, {3.6848423882867327`*^9, 
   3.684842405529766*^9}, {3.6973721255141087`*^9, 3.6973721367031593`*^9}, {
   3.69737218956321*^9, 3.6973721900413427`*^9}, {3.714828670559731*^9, 
   3.714828679535007*^9}, {3.714828729439602*^9, 3.714828730942483*^9}, {
   3.723823742440256*^9, 3.723823744296032*^9}, {3.723823809852248*^9, 
   3.723823815506072*^9}, {3.724347042986565*^9, 3.724347044174521*^9}, {
   3.7257319351993933`*^9, 3.72573198343349*^9}, {3.725732591739622*^9, 
   3.7257325936990957`*^9}, {3.725732630557047*^9, 3.725732638814502*^9}, 
   3.7309729203313837`*^9, {3.7309754366918*^9, 3.730975447316677*^9}, 
   3.730975667525783*^9, {3.739933479840094*^9, 3.739933480883424*^9}, {
   3.7644926807511473`*^9, 3.7644926873330173`*^9}, 3.7645659601357737`*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"b122b5dd-6d88-428d-b206-19746a42f1f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc1FrameNetwork", "[", 
   RowBox[{"t_", ",", "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<index\>\"", ",", "\"\<concentration\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"timingLabel", "[", 
        RowBox[{"t", ",", "t0", ",", "dt"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{"phaseFlag", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}]}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", "}"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.682489770670911*^9, 3.682489830240183*^9}, {
   3.6824898641558933`*^9, 3.682489865275144*^9}, {3.682489999951406*^9, 
   3.6824900363089743`*^9}, 3.682492516335971*^9, {3.6825043092379513`*^9, 
   3.682504360629251*^9}, {3.682778495256693*^9, 3.682778532489546*^9}, {
   3.7053138906804028`*^9, 3.705313893147249*^9}, {3.7114564247954965`*^9, 
   3.7114564362065134`*^9}, {3.714828683533914*^9, 3.7148286836183367`*^9}, 
   3.72573197706256*^9, {3.725732145377955*^9, 3.725732173839614*^9}, 
   3.725732360194148*^9, {3.730972938988998*^9, 3.7309729414848967`*^9}, 
   3.738086924955452*^9, {3.755721397913547*^9, 3.755721398751315*^9}, {
   3.755721461214274*^9, 3.755721490146599*^9}, 3.7645690220073853`*^9, {
   3.764569099566757*^9, 
   3.764569107342637*^9}},ExpressionUUID->"37efe008-574f-447e-9101-\
503a5c425460"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc2FrameNetwork", "[", 
   RowBox[{"t_", ",", "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"concentrationLabel", ",", "concentrationPlot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<concentrations\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "v", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}],
                "}"}], ",", 
              RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<node index\>\"", ",", "\"\<concentration\>\""}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"ns", "+", "1"}]}], "}"}], ",", 
                 RowBox[{
                 "varsPlotRange", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
              RowBox[{"PlotLegends", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<u\>\"", ",", "\"\<v\>\""}], "}"}]}]}], "]"}], 
            ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "v", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}],
                "}"}], ",", 
              RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"ns", "+", "1"}]}], "}"}], ",", 
                 RowBox[{
                 "varsPlotRange", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"AbsolutePointSize", "[", "6", "]"}]}]}], "]"}]}], 
           "\n", "\t", "]"}]}], "}"}], "\n", ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phaseSpaceLabel", ",", "phaseSpacePlot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"phaseSpaceFlag", ",", 
        RowBox[{"{", "\n", "\t", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<phase space\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"zbke2kPhasePlanePlot", "[", 
           RowBox[{
            RowBox[{
            "uvData", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            ",", "uIso", ",", "vIso", ",", "uvflow", ",", "nullclines", ",", 
            "lcdata", ",", "fp"}], "]"}]}], "\n", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"periodLabel", ",", "periodplot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"calcPeriodFlag", ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<period\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"ListLinePlot", "[", 
              RowBox[{
               RowBox[{
               "interpolPeriods", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<node index\>\"", ",", "\"\<period\>\""}], 
                 "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"ns", "+", "1"}]}], "}"}], ",", "Automatic"}], 
                 RowBox[{"(*", 
                  RowBox[{"{", 
                   RowBox[{"p1", ",", "p2"}], "}"}], "*)"}], "}"}]}]}], "]"}],
              ","}]}], "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
            "interpolPeriods", "\[LeftDoubleBracket]", "t", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<node index\>\"", ",", "\"\<period\>\""}], "}"}]}], 
            ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"ns", "+", "1"}]}], "}"}], ",", "Automatic"}], 
              RowBox[{"(*", 
               RowBox[{"{", 
                RowBox[{"p1", ",", "p2"}], "}"}], "*)"}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"AbsolutePointSize", "[", "6", "]"}]}], ",", 
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<periods\>\"", ",", "White"}], "]"}]}]}], "]"}]}], 
         "\n", "\t", 
         RowBox[{"(*", "]", "*)"}], "\n", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phaseLabel", ",", "phaseplot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"calcPhaseFlag", ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<phase\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"ListLinePlot", "[", 
              RowBox[{
               RowBox[{
               "phase", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"ns", "+", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.0", ",", 
                    RowBox[{"2.0", "\[Pi]"}]}], "}"}]}], "}"}]}]}], "]"}], 
             ","}]}], "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
            "phase", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<node index\>\"", ",", "\"\<phase \[Phi]\>\""}], 
              "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"ns", "+", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.0", ",", 
                 RowBox[{"2.0", "\[Pi]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"AbsolutePointSize", "[", "6", "]"}]}]}], "]"}]}], "\n", 
         "\t", 
         RowBox[{"(*", "]", "*)"}], "\n", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"timingLabel", "[", 
           RowBox[{"t", ",", "t0", ",", "dt"}], "]"}], ",", "SpanFromLeft"}], 
         "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{"concentrationLabel", ",", "phaseLabel"}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{"concentrationPlot", ",", "phaseplot"}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{"periodLabel", ",", "phaseSpaceLabel"}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{"periodplot", ",", "phaseSpacePlot"}], "}"}]}], "\n", "}"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.682489770670911*^9, 3.682489830240183*^9}, {
   3.6824898641558933`*^9, 3.682489865275144*^9}, {3.682489999951406*^9, 
   3.6824900363089743`*^9}, 3.682492516335971*^9, {3.6825043092379513`*^9, 
   3.682504360629251*^9}, {3.682778495256693*^9, 3.682778532489546*^9}, {
   3.7053138906804028`*^9, 3.705313893147249*^9}, {3.7114564247954965`*^9, 
   3.7114564362065134`*^9}, {3.714828683533914*^9, 3.7148286836183367`*^9}, 
   3.72573197706256*^9, {3.725732145377955*^9, 3.725732173839614*^9}, 
   3.725732360194148*^9, 3.725732407249514*^9, {3.7257324687038507`*^9, 
   3.725732481044175*^9}, {3.725732528439399*^9, 3.725732559644067*^9}, 
   3.730972947489707*^9, {3.7309757234166317`*^9, 3.730975753674829*^9}, {
   3.7309758365153313`*^9, 3.730975898106802*^9}, {3.730975949648535*^9, 
   3.730975982299054*^9}, {3.730976016967538*^9, 3.730976057468926*^9}, {
   3.73097619294499*^9, 3.730976319936928*^9}, {3.7309765590847588`*^9, 
   3.7309765616977997`*^9}, 3.730976630028328*^9, {3.730976748400229*^9, 
   3.730976750362005*^9}, {3.7309768150978327`*^9, 3.730976824168007*^9}, {
   3.730980438691723*^9, 3.73098046421417*^9}, {3.730987971049315*^9, 
   3.730988094191206*^9}, 3.730988227444172*^9, {3.7382968883677797`*^9, 
   3.738296893599867*^9}, 3.738297758325796*^9, {3.7383006418272057`*^9, 
   3.738300661494627*^9}, {3.7383007598942204`*^9, 3.7383008354378033`*^9}, {
   3.738300939853491*^9, 3.738300976552812*^9}, {3.738301195567892*^9, 
   3.738301253086832*^9}, {3.73830134731385*^9, 3.738301379963972*^9}, {
   3.738310670483159*^9, 3.7383106966686563`*^9}, {3.739781473202795*^9, 
   3.739781481179364*^9}, {3.739781517200013*^9, 3.739781524809616*^9}, {
   3.739874449687044*^9, 3.739874579159194*^9}, {3.76449251745957*^9, 
   3.76449251802884*^9}, {3.764492574716001*^9, 3.7644926498207827`*^9}, {
   3.764493527203988*^9, 3.764493596760057*^9}, {3.764568127286757*^9, 
   3.764568142604261*^9}, {3.764569115905611*^9, 
   3.764569125448225*^9}},ExpressionUUID->"2788616b-5710-44ec-b266-\
1f48ea2e0c38"]
}, Closed]],

Cell[CellGroupData[{

Cell["visualizer1d", "Subsubsection",
 CellChangeTimes->{{3.725731868849668*^9, 3.725731870394858*^9}, 
   3.7257320035253487`*^9},ExpressionUUID->"b3ec420a-5ac6-40f3-a96f-\
88c63819d2de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"visualizer1d", "[", "nc_", "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"nc", "\[IndentingNewLine]", "\n", ",", "1", ",", "\n", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tt", "=", "t"}], ";", 
       RowBox[{"opic", "=", 
        RowBox[{"nc1Frame1d", "[", 
         RowBox[{"t", ",", "0.0"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", "nstates", ",", "1", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
        RowBox[{"AnimationRate", "\[Rule]", "10"}]}], "}"}], ",", 
      RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
       RowBox[{"{", "t", "}"}]}]}], "]"}], "\[IndentingNewLine]", "\n", ",", 
    "2", ",", "\n", 
    RowBox[{
     RowBox[{"uvData", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
            "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
            "v", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "nstates"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{"showLCflag", ",", 
       RowBox[{
        RowBox[{"lcdata0", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{
          "uvData", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", 
        RowBox[{"lcpath", "=", 
         RowBox[{
          RowBox[{"FindShortestTour", "[", "lcdata0", "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tt", "=", "t"}], ";", 
        RowBox[{"opic", "=", 
         RowBox[{"nc2Frame1d", "[", 
          RowBox[{"t", ",", "0.0"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", "\"\<time step t\>\""}], "}"}], ",", 
         "1", ",", "nstates", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
         RowBox[{"AnimationRate", "\[Rule]", "10"}]}], "}"}], ",", 
       RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
        RowBox[{"{", "t", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", "_", ",", 
    RowBox[{"Print", "[", "\"\<nc not supported\>\"", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.668411814649486*^9, 3.6684118341036777`*^9}, {
   3.668411938224527*^9, 3.668412069402886*^9}, {3.668412301009351*^9, 
   3.668412301200664*^9}, {3.6684321730810432`*^9, 3.6684321789789677`*^9}, {
   3.6686986263883467`*^9, 3.668698626482737*^9}, {3.668699058929884*^9, 
   3.668699071096651*^9}, {3.668699117227734*^9, 3.668699157445837*^9}, {
   3.669010740410284*^9, 3.669010748899179*^9}, {3.66901092898918*^9, 
   3.669010961113996*^9}, {3.674390784060534*^9, 3.674390810955093*^9}, {
   3.674404062244286*^9, 3.674404062575766*^9}, {3.674404158416294*^9, 
   3.674404196637217*^9}, {3.6744058618346643`*^9, 3.674405879669791*^9}, {
   3.678870449415709*^9, 3.6788704560031233`*^9}, {3.6788705227996807`*^9, 
   3.678870541201662*^9}, {3.678870622825344*^9, 3.678870640604553*^9}, {
   3.678870699347999*^9, 3.678870771633906*^9}, 3.6790745774291553`*^9, {
   3.679074644064931*^9, 3.679074655317416*^9}, {3.679113798768383*^9, 
   3.679113813187026*^9}, {3.679113974298314*^9, 3.6791139945865917`*^9}, {
   3.679217347097267*^9, 3.679217349190832*^9}, {3.679217390843746*^9, 
   3.679217426470125*^9}, {3.679217465350062*^9, 3.679217477925071*^9}, {
   3.679217539731575*^9, 3.679217541680958*^9}, {3.679217589569471*^9, 
   3.679217600729249*^9}, {3.679217728660283*^9, 3.6792177860540533`*^9}, {
   3.679217923695774*^9, 3.6792179506453457`*^9}, {3.679217985144215*^9, 
   3.6792180072289352`*^9}, {3.67921822758447*^9, 3.679218249090651*^9}, 
   3.6792205338001738`*^9, {3.680521392355014*^9, 3.680521420400457*^9}, {
   3.680529104089664*^9, 3.680529133401041*^9}, {3.681579899730311*^9, 
   3.6815799056240263`*^9}, {3.68158031977138*^9, 3.681580329232633*^9}, {
   3.681894663280854*^9, 3.681894724942687*^9}, {3.6818948440493526`*^9, 
   3.681894871622698*^9}, {3.681894917394981*^9, 3.681894966414114*^9}, {
   3.681895229720792*^9, 3.681895344431753*^9}, {3.681895414551293*^9, 
   3.681895459857338*^9}, 3.681895520399269*^9, {3.681895664790264*^9, 
   3.681895677867165*^9}, {3.6818957545897417`*^9, 3.681895764272451*^9}, {
   3.681896381175384*^9, 3.681896401569449*^9}, {3.681897517245496*^9, 
   3.681897517458893*^9}, {3.681897554159525*^9, 3.681897567811441*^9}, {
   3.681959858832119*^9, 3.681959862182825*^9}, {3.6821546561407347`*^9, 
   3.682154682020873*^9}, 3.6821547991812563`*^9, 3.682154921611393*^9, {
   3.682490012562806*^9, 3.682490015101344*^9}, {3.68249009858948*^9, 
   3.682490242543503*^9}, {3.6824903519413424`*^9, 3.6824903561019583`*^9}, {
   3.6825042822443113`*^9, 3.6825042838293543`*^9}, {3.6827780803272676`*^9, 
   3.6827780925764227`*^9}, {3.682778649596073*^9, 3.682778657522019*^9}, {
   3.6848243119417467`*^9, 3.684824322246684*^9}, {3.6848423882867327`*^9, 
   3.684842405529766*^9}, {3.6973721255141087`*^9, 3.6973721367031593`*^9}, {
   3.69737218956321*^9, 3.6973721900413427`*^9}, {3.714828670559731*^9, 
   3.714828679535007*^9}, {3.714828729439602*^9, 3.714828730942483*^9}, {
   3.723823742440256*^9, 3.723823744296032*^9}, {3.723823809852248*^9, 
   3.723823815506072*^9}, {3.724347042986565*^9, 3.724347044174521*^9}, {
   3.7257319351993933`*^9, 3.72573198343349*^9}, {3.725732591739622*^9, 
   3.7257325936990957`*^9}, {3.725732630557047*^9, 3.725732638814502*^9}, {
   3.76449247433609*^9, 3.764492474960238*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"4c350a97-9dce-428a-8973-0b3c23470109"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc1Frame1d", "[", 
   RowBox[{"t_", ",", "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\t", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<index\>\"", ",", "\"\<concentration\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"timingLabel", "[", 
        RowBox[{"t", ",", "t0", ",", "dt"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.682489770670911*^9, 3.682489830240183*^9}, {
   3.6824898641558933`*^9, 3.682489865275144*^9}, {3.682489999951406*^9, 
   3.6824900363089743`*^9}, 3.682492516335971*^9, {3.6825043092379513`*^9, 
   3.682504360629251*^9}, {3.682778495256693*^9, 3.682778532489546*^9}, {
   3.7053138906804028`*^9, 3.705313893147249*^9}, {3.7114564247954965`*^9, 
   3.7114564362065134`*^9}, {3.714828683533914*^9, 3.7148286836183367`*^9}, 
   3.72573197706256*^9, {3.725732145377955*^9, 3.725732173839614*^9}, 
   3.725732360194148*^9, 3.76456817612458*^9, 3.764569029081327*^9, 
   3.764569134654282*^9},ExpressionUUID->"5dc78737-86c3-4c82-971b-\
7971b6aba3a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc2Frame1d", "[", 
   RowBox[{"t_", ",", "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "phaseplot"}], " ", "**)"}], "\n", 
    RowBox[{
     RowBox[{"phasePlot", "=", 
      RowBox[{"If", "[", 
       RowBox[{"calcPhaseFlag", ",", "\n", 
        RowBox[{"Show", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{
            "phase", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "ns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<oscillator index\>\"", ",", "\"\<phase \[Phi]\>\""}], 
              "}"}]}]}], "]"}], ",", "\n", "\t", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
            "phase", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "ns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}]}], "]"}]}], "\n", "]"}],
         "\n", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"phaseCirclePlot", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calcPhaseFlag", "\[And]", "phaseCircleQ"}], ",", "\n", "\t", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "@", "#"}], ",", 
              RowBox[{"Sin", "@", "#"}]}], "}"}], "&"}], "/@", 
           RowBox[{
           "phase", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"ColorData", "[", "\"\<CherryTones\>\"", "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"1.2", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\""}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], ",", 
          RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "12", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
            "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "300"}], "}"}]}], ",", 
          RowBox[{"Prolog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Circle", "[", "]"}]}], "}"}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"cplot", "=", 
      RowBox[{"If", "[", 
       RowBox[{"concentrationsQ", ",", "\n", "\t", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "v", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<unit index\>\"", ",", "\"\<concentration\>\""}], 
              "}"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"PlotLabel", "->", 
               RowBox[{"MinMax", "/@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "v", "\[LeftDoubleBracket]", "t", 
                   "\[RightDoubleBracket]"}]}], "}"}]}]}], ","}], "*)"}], 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "ns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.02"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<u\>\"", ",", "\"\<v\>\""}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "u", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "v", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", 
            RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "ns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.02"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"AbsolutePointSize", "[", "6", "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t", "]"}], "\n", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phaseSpaceLabel", ",", "phaseSpacePlot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"phaseSpaceFlag", ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<phase space\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{"zbke2kFlag", ",", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{"*", " ", 
              RowBox[{"zbke2k", ":", " ", "loglog"}]}], " ", "**)"}], "\n", 
            "\t\t", 
            RowBox[{"zbke2kPhasePlanePlot", "[", 
             RowBox[{
              RowBox[{
              "uvData", "\[LeftDoubleBracket]", "t", 
               "\[RightDoubleBracket]"}], ",", "uIso", ",", "vIso", ",", 
              "uvflow", ",", "nullclines", ",", "lcdata", ",", "fp"}], "]"}], 
            ",", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{"*", " ", "other", " ", "systems"}], " ", "**)"}], "\n", 
            "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"logFlag", ",", "ListLogLogPlot", ",", "ListPlot"}], 
              "]"}], "[", 
             RowBox[{
              RowBox[{
              "uvData", "\[LeftDoubleBracket]", "t", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"50", ",", "35"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "300"}], "}"}]}], ",", "\n", 
              "\t\t\t", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<u\>\"", ",", "\"\<v\>\""}], "}"}]}], ",", 
              RowBox[{"RotateLabel", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "12", ",", 
                 RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"All", ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", "\n", 
              "\t\t\t", 
              RowBox[{"PlotRange", "\[Rule]", "varsPlotRange"}], ",", "\n", 
              "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{"showLCflag", ",", 
                RowBox[{"Prolog", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", 
                   RowBox[{"Line", "@", 
                    RowBox[{
                    "data", "\[LeftDoubleBracket]", "path", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", "Nothing"}], 
               "]"}], ",", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{"isoQ", ",", "\n", "\t\t\t\t", 
                RowBox[{"Epilog", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"varsPlotRange", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"varsPlotRange", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"logFlag", ",", 
                    RowBox[{"Log", "@", "#"}], ",", "#"}], "]"}]}], "&"}], 
                    "@", "uIso"}], ",", "Blue", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"varsPlotRange", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"varsPlotRange", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    "#"}], "}"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"logFlag", ",", 
                    RowBox[{"Log", "@", "#"}], ",", "#"}], "]"}]}], "&"}], 
                    "@", "vIso"}]}], "}"}]}], ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", 
             "\t\t", "]"}]}], "\n", "\t", "]"}]}], "\n", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"periodLabel", ",", "periodplot"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"calcPeriodFlag", ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<period\>\"", ",", "Black", ",", "20", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
          ",", "\n", "\t", 
          RowBox[{"Show", "[", "\n", "\t\t", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"dt", " ", 
               RowBox[{
               "interpolPeriods", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "ns"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p1", ",", "p2"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Evaluate", "[", "plotops", "]"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<oscillator index\>\"", ",", "\"\<periods T\>\""}], 
                "}"}]}]}], "]"}], ",", "\n", "\t\t", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"dt", " ", 
               RowBox[{
               "interpolPeriods", "\[LeftDoubleBracket]", "t", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "ns"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p1", ",", "p2"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Evaluate", "[", "plotops", "]"}]}], "]"}]}], "\n", 
           "\t", "]"}]}], "\n", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nothing", ",", "Nothing"}], "}"}]}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "output"}], " ", "**)"}], "\n", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"timingLabel", "[", 
           RowBox[{"t", ",", "t0", ",", "dt"}], "]"}], ",", "SpanFromLeft"}], 
         "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{
         "cplot", ",", "phasePlot", ",", "phaseCirclePlot", ",", 
          "phaseSpacePlot", ",", "periodplot"}], "}"}]}], "}"}], "]"}]}]}], 
   "\n", "\n", "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.682489770670911*^9, 3.682489830240183*^9}, {
   3.6824898641558933`*^9, 3.682489865275144*^9}, {3.682489999951406*^9, 
   3.6824900363089743`*^9}, 3.682492516335971*^9, {3.6825043092379513`*^9, 
   3.682504360629251*^9}, {3.682778495256693*^9, 3.682778532489546*^9}, {
   3.7053138906804028`*^9, 3.705313893147249*^9}, {3.7114564247954965`*^9, 
   3.7114564362065134`*^9}, {3.714828683533914*^9, 3.7148286836183367`*^9}, 
   3.72573197706256*^9, {3.725732145377955*^9, 3.725732173839614*^9}, 
   3.725732360194148*^9, 3.725732407249514*^9, {3.7257324687038507`*^9, 
   3.725732481044175*^9}, {3.725732528439399*^9, 3.725732559644067*^9}, {
   3.738296919412652*^9, 3.738296945134954*^9}, {3.756901654860763*^9, 
   3.75690168526381*^9}, {3.7569017316164503`*^9, 3.756901789573577*^9}, {
   3.756901928923984*^9, 3.756902007971346*^9}, {3.756902046116922*^9, 
   3.756902048721012*^9}, {3.7569021961138077`*^9, 3.7569022169092903`*^9}, {
   3.764493704949259*^9, 3.7644937596694736`*^9}, {3.7644941972475224`*^9, 
   3.7644942015358267`*^9}, 3.764568089552656*^9, {3.764568190855762*^9, 
   3.764568211367284*^9}},ExpressionUUID->"c936fbb9-4e4c-42ad-b28c-\
db10c17d2d30"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["zbke2kPhasePlanePlot", "Subsection",
 CellChangeTimes->{{3.6743702513713093`*^9, 
  3.674370260187805*^9}},ExpressionUUID->"c2067fe6-c074-4767-b987-\
c4050fb43221"],

Cell[CellGroupData[{

Cell["initialize data", "Subsubsection",
 CellChangeTimes->{{3.674370820374778*^9, 3.6743708232707243`*^9}, {
  3.6909598428271084`*^9, 
  3.690959847794939*^9}},ExpressionUUID->"b834a2ff-228b-4f7a-b6f8-\
ad0957b9cde4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]1", "=", "0.11"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]2", "=", "1.7*^-5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]3", "=", "1.6*^-3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]", "=", "1.7*^-5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "1.2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "2.4*^-4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"q", "=", "0.70"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "=", "5.25*^-4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uss", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1.0", "/", 
     RowBox[{"(", 
      RowBox[{"4.0", "*", "\[Gamma]", "*", "\[Epsilon]2"}], ")"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"1.0", "-", "v"}], ")"}]}], "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1.0", "-", 
        RowBox[{"2.0", " ", "v"}], "+", 
        RowBox[{"v", "^", "2"}], "+", 
        RowBox[{"16.0", "*", "\[Gamma]", "*", "\[Epsilon]2", "*", "u"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", " ", "v"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Epsilon]3", "+", "1.0", "-", "v"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1.0", "/", "\[Epsilon]1"}], "*", 
    RowBox[{"(", 
     RowBox[{"\[Phi]", "-", 
      RowBox[{"u", "^", "2"}], "-", "u", "+", 
      RowBox[{"\[Epsilon]2", "*", "\[Gamma]", "*", 
       RowBox[{
        RowBox[{"uss", "[", 
         RowBox[{"u", ",", "v"}], "]"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"uss", "[", 
        RowBox[{"u", ",", "v"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1.", "-", "v"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Mu]", "-", "u"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"\[Mu]", "+", "u"}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", "*", 
          RowBox[{"temp", "[", "v", "]"}]}], "+", "\[Beta]"}], ")"}]}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"f2", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2.0", "\[Phi]"}], "+", 
    RowBox[{
     RowBox[{"uss", "[", 
      RowBox[{"u", ",", "v"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1.0", "-", "v"}], ")"}]}], "-", 
    RowBox[{"temp", "[", "v", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqs", "=", 
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "fixed", " ", "point"}], " ", "**)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fp", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}], "/.", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "eqs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "[", 
            RowBox[{"u", ",", "v"}], "]"}], "==", "0."}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0.1"}], "}"}]}], "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "limit", " ", "cycle"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{"{", 
    RowBox[{"0.4", ",", "0.01"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tfinal", "=", "130"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nlcpoints", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", "=", "0.01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"u", ",", "v"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"traj", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{
          RowBox[{"u", "[", "t", "]"}], ",", 
          RowBox[{"v", "[", "t", "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{
          RowBox[{"u", "[", "t", "]"}], ",", 
          RowBox[{"v", "[", "t", "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", "0", "]"}], ",", 
          RowBox[{"v", "[", "0", "]"}]}], "}"}], "\[Equal]", "ic"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tfinal"}], "}"}], ",", 
     RowBox[{"MaxSteps", "\[Rule]", "200000"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"v", "/.", "traj"}], "]"}], "[", "t", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"0.4", "tfinal"}], ",", "tfinal", ",", "dt"}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"peakpositions", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FindPeaks", "[", 
       RowBox[{
        RowBox[{"data", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"1.0*^-10", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "]"}]}], ",", "3"}], "]"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"1", "|", 
      RowBox[{"Length", "@", "data"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"peakpositions", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ";;"}], "]"}], "]"}], "dt"}], "+", 
    RowBox[{"0.4", "tfinal"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lcdata", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "t", "]"}], "&"}], "/@", 
       RowBox[{"traj", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "t1", ",", "t2", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t2", "-", "t1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"nlcpoints", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "contours"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"umin", ",", "umax"}], "}"}], "=", 
   RowBox[{"1.0", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vmin", ",", "vmax"}], "}"}], "=", 
   RowBox[{"1.0", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plottedContours", "=", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"u", ",", "v"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"u", ",", "v"}], "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "umin", ",", "umax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "vmin", ",", "vmax"}], "}"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "70"}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "5"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"points0", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Normal", "@", "plottedContours"}], ",", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"pts_", ",", "___"}], "]"}], "\[RuleDelayed]", "pts"}], ",", 
     "Infinity"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nullclines", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MovingAverage", "[", 
        RowBox[{
         RowBox[{"points0", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{";;", ";;", "10"}]}], "]"}], "]"}], ",", "10"}], "]"}], 
       ",", 
       RowBox[{"points0", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{";;", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u1", ",", "u2", ",", "nu"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.0001", ",", "1", ",", "100"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2", ",", "nv"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.025", ",", "1", ",", "100"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"usLog", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"10.", "^", "u"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"Log10", "@", "u1"}], ",", 
       RowBox[{"Log10", "@", "u2"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log10", "@", "u2"}], "-", 
          RowBox[{"Log10", "@", "u1"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nu", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vsLog", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"10.", "^", "v"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"Log10", "@", "v1"}], ",", 
       RowBox[{"Log10", "@", "v2"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log10", "@", "v2"}], "-", 
          RowBox[{"Log10", "@", "v1"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nv", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uvflow", "=", 
    RowBox[{"Log10", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "eqs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "eqs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "[", 
           RowBox[{"u", ",", "v"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "usLog"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "vsLog"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"u0", "=", 
   RowBox[{"10.", "^", 
    RowBox[{"Floor", "[", 
     RowBox[{"Log10", "[", "u1", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTicksSmall", "=", 
   RowBox[{"Log10", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"u0", "<", "1"}], ",", 
         RowBox[{
          RowBox[{"Sow", "[", 
           RowBox[{
            RowBox[{"Range", "[", "9", "]"}], "u0"}], "]"}], ";", 
          RowBox[{"u0", "*=", "10"}]}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", 
   RowBox[{"10.", "^", 
    RowBox[{"Floor", "[", 
     RowBox[{"Log10", "[", "v1", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vTicksSmall", "=", 
    RowBox[{"Log10", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"v0", "<", "1"}], ",", 
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{
             RowBox[{"Range", "[", "9", "]"}], "v0"}], "]"}], ";", 
           RowBox[{"v0", "*=", "10"}]}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"xlogTicks0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"u", ",", "1"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", 
         RowBox[{"Superscript", "[", 
          RowBox[{"10", ",", 
           RowBox[{"Round", "@", "u"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.016", ",", "0"}], "}"}]}], "}"}], ",", "Nothing"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"Log10", "[", "u1", "]"}], "]"}], ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"Log10", "[", "u2", "]"}], "]"}], ",", "0.1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xlogTicksSmall", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "\"\<\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0.008", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "uTicksSmall"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xlogTicks", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"xlogTicks0", ",", "xlogTicksSmall"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ylogTicks0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"v", ",", "1"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"Superscript", "[", 
          RowBox[{"10", ",", 
           RowBox[{"Round", "@", "v"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.016", ",", "0"}], "}"}]}], "}"}], ",", "Nothing"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"Log10", "[", "v1", "]"}], "]"}], ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"Log10", "[", "v2", "]"}], "]"}], ",", "0.1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ylogTicksSmall", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "\"\<\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0.008", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "vTicksSmall"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ylogTicks", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"ylogTicks0", ",", "ylogTicksSmall"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"xlogTicks2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<\>\"", ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
      "}"}], "&"}], "/@", "xlogTicks"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ylogTicks2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<\>\"", ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
      "}"}], "&"}], "/@", "ylogTicks"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.674371978639432*^9, 3.6743719786400642`*^9}, {
   3.6743721479160013`*^9, 3.674372151326457*^9}, {3.674372216222993*^9, 
   3.674372238727056*^9}, {3.674372298860557*^9, 3.67437230432262*^9}, {
   3.6743723357144136`*^9, 3.674372344927231*^9}, {3.67437248164505*^9, 
   3.674372497339954*^9}, 3.674372557740239*^9, {3.674373306570804*^9, 
   3.67437330689415*^9}, {3.674373415548841*^9, 3.674373422738225*^9}, {
   3.674373473594893*^9, 3.674373480580971*^9}, {3.67437352800945*^9, 
   3.674373539655963*^9}, {3.6743737320948687`*^9, 3.6743737333746367`*^9}, 
   3.674373780780216*^9, 3.674373923634213*^9, 3.674374022323305*^9, 
   3.674374132940786*^9, {3.674374173751322*^9, 3.674374174175701*^9}, {
   3.6743742249582167`*^9, 3.674374242069324*^9}, 3.6743743042116737`*^9, 
   3.674374421178336*^9, 3.6743746692554493`*^9, {3.674374889340873*^9, 
   3.674374889800681*^9}, {3.6743749342570343`*^9, 3.6743749366341248`*^9}, {
   3.6743778323488083`*^9, 3.6743779031771183`*^9}, {3.6743784459151506`*^9, 
   3.674378448562027*^9}, {3.674391992876875*^9, 3.6743919931740828`*^9}, {
   3.674401273460491*^9, 3.674401312400978*^9}, {3.674401384158368*^9, 
   3.674401510943859*^9}, 3.674401921491207*^9, {3.6744020578539143`*^9, 
   3.674402058916444*^9}, {3.674402165280629*^9, 3.674402194809515*^9}, {
   3.674402272634741*^9, 3.6744023062052307`*^9}, {3.6744023593061657`*^9, 
   3.674402367551652*^9}, {3.6744024313417892`*^9, 3.674402486048876*^9}, {
   3.7194137788701057`*^9, 3.719413783068075*^9}, 3.764565154993394*^9, {
   3.764569556824067*^9, 
   3.764569587726149*^9}},ExpressionUUID->"a43a7ddb-34cb-42ec-b949-\
31787f1f642c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["code", "Subsubsection",
 CellChangeTimes->{{3.674370812693955*^9, 
  3.67437081297369*^9}},ExpressionUUID->"7582c537-c051-49f5-950c-\
91ed7e9cce13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zbke2kPhasePlanePlot", "[", 
   RowBox[{
   "uvData_", ",", "uIso_", ",", "vIso_", ",", "uvflow_", ",", "nullclines_", 
    ",", "limitCycle_", ",", "fp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Log10", "@", "nullclines"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Dashed"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Lighter", "@", "Gray"}], ",", "Dashed"}], "]"}]}], 
          "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"Log10", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.0001", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.025", ",", "1"}], "}"}]}], "}"}]}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\n", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<u\>\"", ",", "\"\<v\>\""}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "14", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], ",", 
        RowBox[{"RotateLabel", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "xlogTicks", ",", "ylogTicks", ",", "xlogTicks2", ",", 
           "ylogTicks2"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "300"}], "}"}]}], ",", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "@", "uIso"}], "\[And]", 
           RowBox[{"NumericQ", "@", "vIso"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "10"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", "10"}], "}"}]}], "}"}], "]"}], "&"}], 
              "@", 
              RowBox[{"Log10", "@", "uIso"}]}], ",", "Blue", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "10"}], ",", "#"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"10", ",", "#"}], "}"}]}], "}"}], "]"}], "&"}], 
              "@", 
              RowBox[{"Log10", "@", "vIso"}]}]}], "}"}]}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "}"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Log10", "@", "limitCycle"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Lighter", "@", "Orange"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Log10", "@", "fp"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], "]"}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"Scaled", "@", "0.02"}]}], "]"}]}], "}"}], "]"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"Log10", "@", "uvData"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.674370280295925*^9, 3.6743703181165667`*^9}, {
   3.674370498321455*^9, 3.674370517482614*^9}, {3.674370566176216*^9, 
   3.6743705940207243`*^9}, {3.674370626406581*^9, 3.674370646001285*^9}, {
   3.674370829998207*^9, 3.67437084922591*^9}, {3.674370884312951*^9, 
   3.674371025205082*^9}, {3.6743710657782373`*^9, 3.67437107281024*^9}, {
   3.674392069698348*^9, 3.6743920911438503`*^9}, {3.674392134992209*^9, 
   3.674392149259324*^9}, {3.674392642534849*^9, 3.674392647872177*^9}, 
   3.6743992106372137`*^9, {3.6743992668139*^9, 3.674399326582028*^9}, {
   3.674404283768868*^9, 3.67440429238547*^9}, {3.674404337535367*^9, 
   3.674404341933058*^9}, {3.6744600839578133`*^9, 3.674460085655398*^9}, {
   3.674460504403822*^9, 3.6744605306784267`*^9}, {3.684769441534704*^9, 
   3.684769448407711*^9}, 3.684769478937564*^9, 3.684769647567329*^9, {
   3.684824381252439*^9, 3.684824382244877*^9}, {3.684842673115984*^9, 
   3.684842673197116*^9}, {3.684842920636921*^9, 3.684842981382186*^9}, 
   3.738297846359536*^9, {3.7645652224460087`*^9, 3.764565241846489*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"b47508f7-fc6c-4ab3-b083-dac98e236568"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["work", "Chapter",
 CellChangeTimes->{{3.635489787636668*^9, 
  3.635489787972185*^9}},ExpressionUUID->"e1c96840-d9d1-4054-b447-\
4331962adf0a"],

Cell[CellGroupData[{

Cell["globally coupled network", "Section",
 CellChangeTimes->{{3.764247037548524*^9, 3.76424703809053*^9}, {
  3.764494700352069*^9, 
  3.764494705908099*^9}},ExpressionUUID->"74aecd7f-6de2-4d3e-bcb2-\
982273dd95fd"],

Cell[CellGroupData[{

Cell["get parameter distribution", "Subsection",
 CellChangeTimes->{{3.635793624200245*^9, 3.635793625655591*^9}, {
   3.66211939087914*^9, 3.6621193957993937`*^9}, 3.6621220140872602`*^9, {
   3.738000349374011*^9, 
   3.7380003515654793`*^9}},ExpressionUUID->"7829dfdd-18c0-43f4-97c0-\
b69e84c2a7b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"doubleFlag", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"type", "=", 
   RowBox[{"If", "[", 
    RowBox[{"doubleFlag", ",", "\"\<Real64\>\"", ",", "\"\<Real32\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramDistroFile", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pth", ",", "\"\<paramDistro.bin\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strm", "=", 
   RowBox[{"OpenRead", "[", 
    RowBox[{"paramDistroFile", ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "nx", "}"}], "=", 
   RowBox[{"BinaryRead", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"{", "\"\<Integer32\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "nx"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"BinaryReadList", "[", 
     RowBox[{"strm", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"type", ",", "n"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "strm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<min: \>\"", ",", 
    RowBox[{"Min", "[", "k", "]"}], ",", "\"\<, max: \>\"", ",", 
    RowBox[{"Max", "[", "k", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"k", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<index i\>\"", ",", "\"\<k\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"k", ",", "10", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6357936735632143`*^9, 3.635793770723547*^9}, {
   3.635793845987164*^9, 3.6357938673498*^9}, {3.6357939169733877`*^9, 
   3.635793918941709*^9}, {3.6357939583760853`*^9, 3.635793960536091*^9}, {
   3.635794306903078*^9, 3.6357943084478893`*^9}, 3.638433051215995*^9, {
   3.638433909491954*^9, 3.638433935049121*^9}, {3.6546772542866087`*^9, 
   3.6546773008813553`*^9}, {3.6546773586813927`*^9, 3.654677433088036*^9}, 
   3.6546858161411533`*^9, {3.738000388588039*^9, 3.738000401636673*^9}, {
   3.738000450196926*^9, 3.738000499921988*^9}, {3.7380005483470182`*^9, 
   3.7380006009919786`*^9}, {3.7380397073528214`*^9, 3.738039711375992*^9}, {
   3.7381490822840347`*^9, 3.738149101086344*^9}, {3.7396758647676487`*^9, 
   3.7396758663448963`*^9}, {3.7644942854635153`*^9, 3.764494290390192*^9}, {
   3.764494329663116*^9, 3.7644943594271193`*^9}, 3.764494646962494*^9, {
   3.764568507648656*^9, 3.764568511944928*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"5e29bc64-076c-40f8-8eb8-d09b6a384c7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Interactive animation", "Subsection",
 CellChangeTimes->{
  3.7309721747032433`*^9},ExpressionUUID->"a3809bd7-434b-48e3-99c8-\
86aed2f80cdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pth", "=", 
    RowBox[{
    "\"\</home/\>\"", "<>", "$UserName", "<>", 
     "\"\</Desktop/Simulations/chimera_state\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extraPlotOps", "=", 
   RowBox[{"{", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"networkQ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mode", ",", "thresh", ",", "interpol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.6", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "doubleFlag", ",", "networkPlotQ", ",", "phaseFlag", ",", "corotateFlag", 
     ",", "corotateIndex"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"True", ",", "False", ",", "True", ",", "True", ",", 
     RowBox[{"Round", "[", 
      RowBox[{"0.5", "n"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"logFlag", ",", "zbke2kFlag", ",", "showLCflag"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"False", ",", "True", ",", "False"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "calcPhaseFlag", ",", "calcPeriodFlag", ",", "phaseSpaceFlag", ",", 
      "isoQ"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"False", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsPlotRange", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], "}"}]}], ";", "    ", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "phase"}], " ", "**)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uIso", ",", "vIso"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0005", ",", "0.2"}], "}"}]}], ";", "        ", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "zbke2k"}], " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"varsPlotRange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"animateNetwork", "[", "pth", "]"}]}]}], "Input",
 CellChangeTimes->{{3.730972181422902*^9, 3.73097218243655*^9}, {
   3.73097221531985*^9, 3.730972216070595*^9}, {3.7309756007309303`*^9, 
   3.7309756053330393`*^9}, {3.73097651089918*^9, 3.730976532604693*^9}, {
   3.730976588909028*^9, 3.7309765964040337`*^9}, 3.7309767622834177`*^9, {
   3.730976833321004*^9, 3.730976846708284*^9}, {3.730977101994672*^9, 
   3.730977105665374*^9}, 3.730980497439494*^9, {3.7309816036772747`*^9, 
   3.730981613578868*^9}, {3.7309825221405077`*^9, 3.7309825224890757`*^9}, {
   3.730986631266055*^9, 3.730986643394658*^9}, {3.7309881760677643`*^9, 
   3.730988177210595*^9}, {3.730988357018982*^9, 3.730988357430573*^9}, {
   3.730988780442149*^9, 3.7309887806709547`*^9}, {3.730988892297387*^9, 
   3.730988900016365*^9}, {3.7379845674665813`*^9, 3.737984590117673*^9}, {
   3.7379846514555073`*^9, 3.737984651914405*^9}, {3.737999846669879*^9, 
   3.737999847268875*^9}, {3.73800062915736*^9, 3.7380006390290003`*^9}, {
   3.7380006952545547`*^9, 3.738000695701384*^9}, {3.738001157914263*^9, 
   3.738001158215217*^9}, {3.738001670995674*^9, 3.738001695254682*^9}, {
   3.738001733290255*^9, 3.738001733952886*^9}, {3.738002129041651*^9, 
   3.7380021383605223`*^9}, {3.7380401157760973`*^9, 3.738040116399905*^9}, {
   3.73808634985701*^9, 3.7380863501868353`*^9}, {3.738087275303053*^9, 
   3.7380872764525127`*^9}, {3.738121980676388*^9, 3.7381219863559523`*^9}, 
   3.7381220426685333`*^9, 3.7381315130306*^9, {3.738136022745091*^9, 
   3.738136023264477*^9}, {3.738138771841208*^9, 3.738138772992488*^9}, {
   3.7382963469987373`*^9, 3.738296347529179*^9}, 3.738296397511613*^9, {
   3.738297141967519*^9, 3.7382971847074547`*^9}, {3.73829722003998*^9, 
   3.738297246419868*^9}, {3.738297428628025*^9, 3.738297518018211*^9}, {
   3.7382975742731733`*^9, 3.7382975750086203`*^9}, {3.7382976699747133`*^9, 
   3.73829769199016*^9}, {3.738297865025832*^9, 3.738297866800302*^9}, {
   3.738300234811377*^9, 3.738300235336617*^9}, {3.738301010244214*^9, 
   3.738301010807465*^9}, {3.738301102270795*^9, 3.738301102612047*^9}, {
   3.738301152963759*^9, 3.7383011669758453`*^9}, {3.738301310864375*^9, 
   3.7383013116500597`*^9}, {3.738301440363777*^9, 3.7383014407313232`*^9}, {
   3.73967564090106*^9, 3.739675649690752*^9}, {3.7397696131551123`*^9, 
   3.7397696328362627`*^9}, {3.739769772739603*^9, 3.739769791747497*^9}, {
   3.7397705234602633`*^9, 3.739770524039888*^9}, {3.739778037611573*^9, 
   3.739778059318035*^9}, {3.739779345151321*^9, 3.739779345678557*^9}, {
   3.7397814350896482`*^9, 3.739781445725996*^9}, {3.739932802772698*^9, 
   3.7399328353990107`*^9}, {3.740298526318042*^9, 3.740298526658033*^9}, {
   3.740298603767271*^9, 3.7402986072452097`*^9}, {3.755626206673917*^9, 
   3.755626207264463*^9}, {3.764494423868773*^9, 3.764494424160074*^9}, {
   3.764568575170927*^9, 3.7645686130930023`*^9}, {3.76456876873055*^9, 
   3.764568814503291*^9}, {3.764568924452381*^9, 3.764568937666462*^9}, {
   3.764568987408564*^9, 3.764568987728147*^9}, 
   3.7645692081046124`*^9},ExpressionUUID->"623fd6b2-9bde-499c-a08e-\
6f73908748ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1d", "Section",
 CellChangeTimes->{{3.635616791832512*^9, 3.635616791896204*^9}, {
   3.635794248729398*^9, 3.635794254473041*^9}, {3.639979173494484*^9, 
   3.63997917609359*^9}, {3.66211971048173*^9, 3.662119718890286*^9}, {
   3.7035738238812437`*^9, 3.703573824025347*^9}, 
   3.764247026722323*^9},ExpressionUUID->"8b5ffd56-ca94-4c23-9c2b-\
ac9dc5d9b2a0"],

Cell[CellGroupData[{

Cell["kernel plot", "Subsection",
 CellChangeTimes->{{3.651221136955679*^9, 3.651221137865625*^9}, {
   3.6513378896063747`*^9, 3.651337891672599*^9}, 
   3.6621197735688334`*^9},ExpressionUUID->"c3461848-e2e3-4a5d-a608-\
4e4f62164321"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pth", ",", "\"\<coupling_kernel.bin\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kernelfile", "=", 
   RowBox[{"OpenRead", "[", 
    RowBox[{"f", ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kernel", "=", 
   RowBox[{"BinaryReadList", "[", 
    RowBox[{"kernelfile", ",", "\"\<Real64\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "#"}]}], "-", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "@", "#"}], "+", "1"}], ")"}]}]}], ",", "#"}], 
       "}"}], "\[Transpose]"}], "&"}], "@", "kernel"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Point", "[", "data", "]"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "14"}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<spatial index i\>\"", ",", "\"\<kernel G[i]\>\""}], "}"}]}],
    ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "400"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6512211820957737`*^9, 3.651221315037271*^9}, {
  3.6512213867069683`*^9, 3.6512214286025267`*^9}, {3.651221599112028*^9, 
  3.6512216138402157`*^9}, {3.65133789949629*^9, 3.6513379201527576`*^9}, {
  3.657865491684431*^9, 3.657865555833992*^9}, {3.6578655975511703`*^9, 
  3.6578656096705303`*^9}, {3.6584191267231503`*^9, 3.658419331017498*^9}, {
  3.658419366854846*^9, 3.658419399073823*^9}, {3.72689947421828*^9, 
  3.7268995682873907`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"1a28cc15-a65a-4746-a991-b613da484a9f"]
}, Closed]],

Cell[CellGroupData[{

Cell["space time plot", "Subsection",
 CellChangeTimes->{{3.764247086486457*^9, 
  3.764247088186364*^9}},ExpressionUUID->"89e95825-e034-49f7-9922-\
68d7fc05c9f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dn", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{";;", "nstates", ";;", "dn"}], "]"}], "]"}], "\[Transpose]"}], 
    ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "GrayLevel"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", "250"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "8"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<index\>\"", ",", "\"\<time\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Length", "@", "u"}], " ", "dt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "nx"}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.674748149860607*^9, 3.674748397385294*^9}, {
   3.675074476009531*^9, 3.675074476145824*^9}, {3.7644945636604147`*^9, 
   3.764494564209875*^9}, {3.76456823410436*^9, 3.764568240989143*^9}, 
   3.764568291259808*^9},
 CellLabel->
  "In[274]:=",ExpressionUUID->"7fb0ceab-82c7-4986-924a-edad8dfaab8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dn", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"[", 
       RowBox[{";;", "nstates", ";;", "dn"}], "]"}], "]"}], "\[Transpose]"}], 
    ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "GrayLevel"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", "250"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "8"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<index\>\"", ",", "\"\<time\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Length", "@", "v"}], " ", "dt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "nx"}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7645683369736357`*^9, 
  3.764568340082452*^9}},ExpressionUUID->"0b134bb6-d5fe-43db-88c1-\
c9f7aba8946b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["animation 1d", "Subsection",
 CellChangeTimes->{{3.635617503458474*^9, 3.6356175040418777`*^9}, {
   3.662119434972027*^9, 3.662119435387816*^9}, 3.662119847944003*^9, {
   3.6621213592491083`*^9, 3.66212135952879*^9}, {3.6621218299943237`*^9, 
   3.662121831747274*^9}, 
   3.764247062010623*^9},ExpressionUUID->"6d839267-0f70-403c-9475-\
49baea49b6ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pth", "=", 
    RowBox[{
    "\"\</home/\>\"", "<>", "$UserName", "<>", 
     "\"\</Desktop/Simulations/chimera_state\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mode", ",", "thresh", ",", "interpol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.6", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "doubleFlag", ",", "phaseFlag", ",", "corotateFlag", ",", "logFlag", ",", 
     "zbke2kFlag", ",", "concentrationsQ"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", 
     "True"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phaseCircleQ", ",", "calcPhaseFlag"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsPlotRange", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], "}"}]}], ";", "    ", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "phase"}], " ", "**)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uIso", ",", "vIso"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0005", ",", "0.2"}], "}"}]}], ";", "        ", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "zbke2k"}], " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"varsPlotRange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"animate1d", "[", "pth", "]"}]}]}], "Input",
 CellChangeTimes->{{3.668698777638484*^9, 3.668698790631187*^9}, {
   3.6687050595386477`*^9, 3.668705060761819*^9}, {3.66901058643497*^9, 
   3.669010600213533*^9}, {3.669010773973805*^9, 3.669010774319132*^9}, {
   3.669010858353071*^9, 3.66901085976679*^9}, {3.669010891148271*^9, 
   3.6690109045401487`*^9}, {3.66901097389966*^9, 3.669010995180709*^9}, {
   3.669935650797608*^9, 3.6699356675967493`*^9}, {3.669937751540794*^9, 
   3.669937776900169*^9}, {3.66993918126791*^9, 3.669939181431549*^9}, {
   3.678870122734229*^9, 3.678870171370091*^9}, {3.678870208736459*^9, 
   3.67887027875881*^9}, {3.6788707848615303`*^9, 3.678870866431044*^9}, {
   3.6789691797713842`*^9, 3.6789692827340517`*^9}, {3.679074426784484*^9, 
   3.6790744473340683`*^9}, {3.679074607089129*^9, 3.679074613231784*^9}, {
   3.679074685423781*^9, 3.679074700987369*^9}, {3.679075486406754*^9, 
   3.6790755331147947`*^9}, 3.6790757263756647`*^9, 3.679112163085538*^9, 
   3.679112195579645*^9, 3.679112237421471*^9, 3.679112937264883*^9, {
   3.67911343572015*^9, 3.6791134561360197`*^9}, {3.6792171708446608`*^9, 
   3.679217227653314*^9}, {3.679217264003031*^9, 3.679217281732822*^9}, {
   3.679218040493971*^9, 3.679218057542931*^9}, {3.679219933021689*^9, 
   3.679219938514175*^9}, {3.680521243361451*^9, 3.680521256008696*^9}, {
   3.681203520376115*^9, 3.6812035243550663`*^9}, {3.682154626243339*^9, 
   3.6821546340256243`*^9}, {3.682155044903813*^9, 3.682155046444615*^9}, {
   3.6821553040258617`*^9, 3.682155306586947*^9}, {3.6904222298652163`*^9, 
   3.690422230890066*^9}, {3.6977429228235598`*^9, 3.697742940942914*^9}, 
   3.69774311660182*^9, 3.697743164166615*^9, {3.6977432224787207`*^9, 
   3.6977432268719587`*^9}, {3.697743785360446*^9, 3.69774378984691*^9}, {
   3.703575965141198*^9, 3.70357606520411*^9}, {3.703576366027603*^9, 
   3.7035763833573003`*^9}, {3.764246279893004*^9, 3.764246290393038*^9}, {
   3.764494839239792*^9, 3.764494844863117*^9}, {3.764502287974677*^9, 
   3.764502303034782*^9}, {3.7645648138296423`*^9, 3.764564849704392*^9}, {
   3.764567728526341*^9, 3.76456776379329*^9}, {3.764568022436738*^9, 
   3.764568032050807*^9}, {3.764568436695898*^9, 3.764568436989382*^9}, 
   3.76456863130894*^9, 
   3.7645691840377398`*^9},ExpressionUUID->"03c37923-8e4e-45c6-9aef-\
54763e1f2896"]
}, Open  ]],

Cell[CellGroupData[{

Cell["spatial parameter distribution", "Subsection",
 CellChangeTimes->{{3.635793624200245*^9, 3.635793625655591*^9}, {
   3.66211939087914*^9, 3.6621193957993937`*^9}, 
   3.6621220140872602`*^9},ExpressionUUID->"371854f2-1782-498d-adba-\
bfe5eef05e3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"doubleFlag", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"type", "=", 
   RowBox[{"If", "[", 
    RowBox[{"doubleFlag", ",", "\"\<Real64\>\"", ",", "\"\<Real32\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramDistroFile", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pth", ",", "\"\<paramDistro.bin\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strm", "=", 
   RowBox[{"OpenRead", "[", 
    RowBox[{"paramDistroFile", ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", "nx", "}"}], "=", 
  RowBox[{"BinaryRead", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"{", "\"\<Integer32\>\"", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "nx"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"BinaryReadList", "[", 
     RowBox[{"strm", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"type", ",", "n"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "strm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<min: \>\"", ",", 
    RowBox[{"Min", "[", "k", "]"}], ",", "\"\<, max: \>\"", ",", 
    RowBox[{"Max", "[", "k", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"k", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<index i\>\"", ",", "\"\<k\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"k", ",", "10", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6357936735632143`*^9, 3.635793770723547*^9}, {
   3.635793845987164*^9, 3.6357938673498*^9}, {3.6357939169733877`*^9, 
   3.635793918941709*^9}, {3.6357939583760853`*^9, 3.635793960536091*^9}, {
   3.635794306903078*^9, 3.6357943084478893`*^9}, 3.638433051215995*^9, {
   3.638433909491954*^9, 3.638433935049121*^9}, {3.6546772542866087`*^9, 
   3.6546773008813553`*^9}, {3.6546773586813927`*^9, 3.654677433088036*^9}, 
   3.6546858161411533`*^9, {3.738663792939104*^9, 3.7386638145393*^9}, {
   3.764501130571588*^9, 3.7645011373677673`*^9}, {3.7645678851050367`*^9, 
   3.7645679076508303`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"e6743d4f-9a4f-46d5-b7b1-7b038e6ddff8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{1218, 759},
WindowMargins->{{137, Automatic}, {Automatic, 46}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 98, "Title",ExpressionUUID->"afb64ab9-a88f-4e8c-9180-e644ef25d755"],
Cell[CellGroupData[{
Cell[768, 29, 154, 3, 69, "Chapter",ExpressionUUID->"954ed11f-c79f-466a-9bd2-2ba72ec62414"],
Cell[CellGroupData[{
Cell[947, 36, 207, 4, 68, "Section",ExpressionUUID->"fb043343-b96a-45be-bb66-2bb7520f1c73"],
Cell[CellGroupData[{
Cell[1179, 44, 154, 3, 55, "Subsection",ExpressionUUID->"66218dfd-368c-4327-8cd6-533a91b0926f"],
Cell[1336, 49, 1001, 25, 142, "Code",ExpressionUUID->"d2a4f3a2-0d37-4f1d-805e-6e69416bfd03"]
}, Closed]],
Cell[CellGroupData[{
Cell[2374, 79, 164, 3, 39, "Subsection",ExpressionUUID->"6461c145-0add-4dcf-be7a-9e9ba124906e"],
Cell[2541, 84, 1025, 28, 186, "Code",ExpressionUUID->"041d0ed5-dc6b-4c80-ba30-4533367f2f6f"]
}, Closed]],
Cell[CellGroupData[{
Cell[3603, 117, 220, 4, 39, "Subsection",ExpressionUUID->"42519363-4e8e-4416-951c-e95a31f04959"],
Cell[3826, 123, 271, 6, 53, "Code",ExpressionUUID->"afbf8e75-a17c-4351-a215-e3d9edeee829"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[4146, 135, 151, 3, 54, "Section",ExpressionUUID->"65b98bf5-ee17-4504-94e6-a03e7b7712d3"],
Cell[CellGroupData[{
Cell[4322, 142, 278, 8, 55, "Subsection",ExpressionUUID->"3c54804e-d535-4a42-a07c-0d86c789e9b0"],
Cell[4603, 152, 648, 14, 70, "Input",ExpressionUUID->"bd912af1-eac0-4284-a2be-67ff3bfbf672"],
Cell[5254, 168, 6396, 145, 70, "Code",ExpressionUUID->"d5ab6054-8073-40ff-a323-a1d06d4c2ede"]
}, Closed]],
Cell[CellGroupData[{
Cell[11687, 318, 208, 4, 39, "Subsection",ExpressionUUID->"0af4994c-4c70-488b-9a77-fca2c0dcd9b3"],
Cell[CellGroupData[{
Cell[11920, 326, 167, 3, 45, "Subsubsection",ExpressionUUID->"a934bdcd-95b0-4267-9a6b-93205ec8b026"],
Cell[12090, 331, 8529, 183, 802, "Code",ExpressionUUID->"dc59cfbd-d3b0-4d07-b8ab-d39aea94830a"]
}, Closed]],
Cell[CellGroupData[{
Cell[20656, 519, 261, 4, 37, "Subsubsection",ExpressionUUID->"a1edc3d8-2915-4d2b-8b75-484b0cd572e5"],
Cell[20920, 525, 267, 5, 31, "Input",ExpressionUUID->"41813902-1edd-42a1-ab81-28327890ecc2"],
Cell[21190, 532, 9637, 209, 758, "Code",ExpressionUUID->"b4f48329-0f18-4e41-a226-e663d26a0c64"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30876, 747, 190, 3, 55, "Subsection",ExpressionUUID->"cdb8f40b-ac9e-4a89-962a-12105ae80cfc"],
Cell[31069, 752, 164, 3, 70, "Text",ExpressionUUID->"a3e8a4cc-0c8d-4173-bb20-c070bfd7d04c"],
Cell[31236, 757, 444, 11, 70, "Input",ExpressionUUID->"f9423b92-06db-426e-af6b-b66aefc8d01b"],
Cell[31683, 770, 1527, 36, 70, "Input",ExpressionUUID->"4352da50-1998-4338-be09-35b090bd581e"],
Cell[CellGroupData[{
Cell[33235, 810, 157, 3, 70, "Subsubsection",ExpressionUUID->"97e0c091-318a-4566-9768-03ab937af242"],
Cell[33395, 815, 6100, 158, 70, "Input",ExpressionUUID->"5751b3a9-b331-4548-95b5-a5b138f77690"]
}, Closed]],
Cell[CellGroupData[{
Cell[39532, 978, 153, 2, 70, "Subsubsection",ExpressionUUID->"8a4a47f5-242b-4dc9-8c90-cbf71060c96a"],
Cell[39688, 982, 6071, 141, 70, "Code",ExpressionUUID->"afe133c3-4aed-48e1-b14c-ca02fc9221e2"]
}, Closed]],
Cell[CellGroupData[{
Cell[45796, 1128, 214, 4, 70, "Subsubsection",ExpressionUUID->"6f020d42-149f-4f64-9921-f8d775614470"],
Cell[46013, 1134, 144, 2, 70, "Input",ExpressionUUID->"0399d467-4e2a-4d47-a94f-2779be650f8e"],
Cell[46160, 1138, 590, 10, 70, "Input",ExpressionUUID->"05b2ba59-5c81-40b4-98cc-a6c2ffda0cd3"],
Cell[46753, 1150, 10572, 214, 70, "Code",ExpressionUUID->"70107c9c-47e4-499a-bb99-b109f3db27f2"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[57374, 1370, 157, 3, 39, "Subsection",ExpressionUUID->"ca6ddbc5-a1b6-4277-9e77-1e5c9612998a"],
Cell[57534, 1375, 590, 16, 70, "Input",ExpressionUUID->"cb844858-01a1-49dc-8a84-f9a12f9dfa39"],
Cell[58127, 1393, 449, 12, 70, "Input",ExpressionUUID->"a79e6b93-ee2b-4cfe-8dde-9c0a2a87d75c"],
Cell[CellGroupData[{
Cell[58601, 1409, 164, 3, 70, "Subsubsection",ExpressionUUID->"bd179d9d-87dd-4fa4-b38f-1fa03a8cc8a3"],
Cell[58768, 1414, 813, 24, 70, "Input",ExpressionUUID->"cc0ded1a-87af-494d-96cd-8a7ad213fd3c"],
Cell[59584, 1440, 1421, 33, 70, "Input",ExpressionUUID->"ac92a75b-1edd-476f-aa5a-9ec9b0996e18"]
}, Closed]],
Cell[CellGroupData[{
Cell[61042, 1478, 212, 4, 70, "Subsubsection",ExpressionUUID->"e486f4af-a978-495d-9fc7-4eb9ce77d394"],
Cell[61257, 1484, 3018, 70, 70, "Input",ExpressionUUID->"eebefb80-6982-424b-90b7-f33ec3032a6a"]
}, Closed]],
Cell[CellGroupData[{
Cell[64312, 1559, 159, 3, 70, "Subsubsection",ExpressionUUID->"5135f093-cfb5-419d-b114-37ecdf7b4ab2"],
Cell[64474, 1564, 16308, 350, 70, "Code",ExpressionUUID->"fa405eb9-b388-4604-a571-5935449fc2d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[80819, 1919, 214, 4, 70, "Subsubsection",ExpressionUUID->"12400b97-75b0-4bc7-85d2-4372b21ce056"],
Cell[81036, 1925, 144, 2, 70, "Input",ExpressionUUID->"1eeec1d0-64a4-4694-b585-3e8a3230149e"],
Cell[81183, 1929, 267, 6, 70, "Input",ExpressionUUID->"2e164679-a1bf-4eeb-818f-a660bb8c1192"],
Cell[81453, 1937, 13017, 288, 70, "Code",ExpressionUUID->"e9f2badf-5ed8-43da-afbf-734428a274d1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[94519, 2231, 158, 3, 39, "Subsection",ExpressionUUID->"e3264696-bfc8-46f1-a7ee-693ddfffc748"],
Cell[94680, 2236, 471, 11, 53, "Code",ExpressionUUID->"26e1fb02-1a46-4371-89f6-516a4ed18c8f"]
}, Closed]],
Cell[CellGroupData[{
Cell[95188, 2252, 192, 4, 39, "Subsection",ExpressionUUID->"03238664-bf25-4399-85a1-23306ce8f61e"],
Cell[95383, 2258, 489, 11, 31, "Input",ExpressionUUID->"30d4c195-47a9-4032-892a-646f69975006"],
Cell[95875, 2271, 3409, 76, 406, "Code",ExpressionUUID->"f200ff3d-fc97-453d-a37f-352e9901f9fd"]
}, Closed]],
Cell[CellGroupData[{
Cell[99321, 2352, 133, 3, 39, "Subsection",ExpressionUUID->"f4a7823b-2e0b-4b2c-ae03-d5c84d185725"],
Cell[99457, 2357, 386, 10, 31, "Input",ExpressionUUID->"0dd418ce-32cc-4784-ba75-81847f22f2d5"],
Cell[99846, 2369, 2442, 54, 296, "Code",ExpressionUUID->"becd7906-2c45-4f1b-aab9-62d76694c993"]
}, Closed]],
Cell[CellGroupData[{
Cell[102325, 2428, 159, 3, 39, "Subsection",ExpressionUUID->"1f49b42f-7ba7-4e4e-89e9-fe6b4a899c00"],
Cell[102487, 2433, 1039, 27, 53, "Code",ExpressionUUID->"181603d2-9243-439c-8401-d24b2d9fcecb"]
}, Closed]],
Cell[CellGroupData[{
Cell[103563, 2465, 160, 3, 39, "Subsection",ExpressionUUID->"ece6d5fa-981e-46c9-af27-04b385f971d0"],
Cell[CellGroupData[{
Cell[103748, 2472, 247, 4, 45, "Subsubsection",ExpressionUUID->"e3b06e43-7d8b-474c-b407-974a3022e323"],
Cell[103998, 2478, 173, 4, 31, "Input",ExpressionUUID->"d887ce41-a4f8-4674-b91d-c67f2b5478bd"],
Cell[104174, 2484, 6152, 115, 296, "Code",ExpressionUUID->"b122b5dd-6d88-428d-b206-19746a42f1f3"],
Cell[110329, 2601, 1822, 39, 98, "Code",ExpressionUUID->"37efe008-574f-447e-9101-503a5c425460"],
Cell[112154, 2642, 11619, 259, 890, "Code",ExpressionUUID->"2788616b-5710-44ec-b266-1f48ea2e0c38"]
}, Closed]],
Cell[CellGroupData[{
Cell[123810, 2906, 188, 3, 37, "Subsubsection",ExpressionUUID->"b3ec420a-5ac6-40f3-a96f-88c63819d2de"],
Cell[124001, 2911, 6035, 114, 296, "Code",ExpressionUUID->"4c350a97-9dce-428a-8973-0b3c23470109"],
Cell[130039, 3027, 1362, 28, 98, "Code",ExpressionUUID->"5dc78737-86c3-4c82-971b-7971b6aba3a6"],
Cell[131404, 3057, 16736, 387, 1176, "Code",ExpressionUUID->"c936fbb9-4e4c-42ad-b28c-db10c17d2d30"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148189, 3450, 170, 3, 55, "Subsection",ExpressionUUID->"c2067fe6-c074-4767-b987-c4050fb43221"],
Cell[CellGroupData[{
Cell[148384, 3457, 219, 4, 45, "Subsubsection",ExpressionUUID->"b834a2ff-228b-4f7a-b6f8-ad0957b9cde4"],
Cell[148606, 3463, 17741, 535, 1286, "Code",ExpressionUUID->"a43a7ddb-34cb-42ec-b949-31787f1f642c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166384, 4003, 154, 3, 45, "Subsubsection",ExpressionUUID->"7582c537-c051-49f5-950c-91ed7e9cce13"],
Cell[166541, 4008, 5567, 126, 252, "Code",ExpressionUUID->"b47508f7-fc6c-4ab3-b083-dac98e236568"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172181, 4142, 149, 3, 69, "Chapter",ExpressionUUID->"e1c96840-d9d1-4054-b447-4331962adf0a"],
Cell[CellGroupData[{
Cell[172355, 4149, 217, 4, 68, "Section",ExpressionUUID->"74aecd7f-6de2-4d3e-bcb2-982273dd95fd"],
Cell[CellGroupData[{
Cell[172597, 4157, 302, 5, 55, "Subsection",ExpressionUUID->"7829dfdd-18c0-43f4-97c0-b69e84c2a7b4"],
Cell[172902, 4164, 3099, 72, 262, "Input",ExpressionUUID->"5e29bc64-076c-40f8-8eb8-d09b6a384c7b"]
}, Closed]],
Cell[CellGroupData[{
Cell[176038, 4241, 147, 3, 39, "Subsection",ExpressionUUID->"a3809bd7-434b-48e3-99c8-86aed2f80cdd"],
Cell[176188, 4246, 5569, 118, 354, "Input",ExpressionUUID->"623fd6b2-9bde-499c-a08e-6f73908748ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181806, 4370, 366, 6, 68, "Section",ExpressionUUID->"8b5ffd56-ca94-4c23-9c2b-ac9dc5d9b2a0"],
Cell[CellGroupData[{
Cell[182197, 4380, 236, 4, 55, "Subsection",ExpressionUUID->"c3461848-e2e3-4a5d-a608-4e4f62164321"],
Cell[182436, 4386, 2369, 62, 193, "Input",ExpressionUUID->"1a28cc15-a65a-4746-a991-b613da484a9f"]
}, Closed]],
Cell[CellGroupData[{
Cell[184842, 4453, 163, 3, 39, "Subsection",ExpressionUUID->"89e95825-e034-49f7-9922-68d7fc05c9f3"],
Cell[185008, 4458, 1726, 43, 101, "Input",ExpressionUUID->"7fb0ceab-82c7-4986-924a-edad8dfaab8f"],
Cell[186737, 4503, 1532, 40, 101, "Input",ExpressionUUID->"0b134bb6-d5fe-43db-88c1-c9f7aba8946b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188306, 4548, 360, 6, 55, "Subsection",ExpressionUUID->"6d839267-0f70-403c-9475-49baea49b6ef"],
Cell[188669, 4556, 4235, 92, 285, "Input",ExpressionUUID->"03c37923-8e4e-45c6-9aef-54763e1f2896"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192941, 4653, 254, 4, 55, "Subsection",ExpressionUUID->"371854f2-1782-498d-adba-bfe5eef05e3e"],
Cell[193198, 4659, 2753, 66, 262, "Input",ExpressionUUID->"e6743d4f-9a4f-46d5-b7b1-7b038e6ddff8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

